(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[70673],{20427:(t,e,o)=>{var i=o(93633);function __default(t){return t&&(t.__esModule?t.default:t)}t.exports=(i.default||i).template({1:function(t,e,o,i,n){return"0"},3:function(t,e,o,i,n){return"-1"},compiler:[8,">= 4.3.0"],main:function(t,e,i,n,r){var s,c,l=null!=e?e:t.nullContext||{},a=t.hooks.helperMissing,d="function",u=t.escapeExpression,h=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<input id="piece-'+u(typeof(c=null!=(c=h(i,"id")||(null!=e?h(e,"id"):e))?c:a)===d?c.call(l,{name:"id",hash:{},data:r,loc:{start:{line:1,column:17},end:{line:1,column:23}}}):c)+"-"+u(typeof(c=null!=(c=h(i,"pos")||(null!=e?h(e,"pos"):e))?c:a)===d?c.call(l,{name:"pos",hash:{},data:r,loc:{start:{line:1,column:24},end:{line:1,column:31}}}):c)+'" alt="'+u(typeof(c=null!=(c=h(i,"alt")||(null!=e?h(e,"alt"):e))?c:a)===d?c.call(l,{name:"alt",hash:{},data:r,loc:{start:{line:1,column:38},end:{line:1,column:45}}}):c)+'"\r\n  data-pos="'+u(typeof(c=null!=(c=h(i,"pos")||(null!=e?h(e,"pos"):e))?c:a)===d?c.call(l,{name:"pos",hash:{},data:r,loc:{start:{line:2,column:12},end:{line:2,column:19}}}):c)+'" data-bs-toggle="dropdown"\r\n  class="piece img-responsive" type="image"\r\n  draggable="true" aria-grabbed="false" aria-expanded="false" aria-haspopup="true"\r\n  aria-controls="dropdown-piece-'+u(typeof(c=null!=(c=h(i,"id")||(null!=e?h(e,"id"):e))?c:a)===d?c.call(l,{name:"id",hash:{},data:r,loc:{start:{line:5,column:32},end:{line:5,column:38}}}):c)+"-"+u(typeof(c=null!=(c=h(i,"pos")||(null!=e?h(e,"pos"):e))?c:a)===d?c.call(l,{name:"pos",hash:{},data:r,loc:{start:{line:5,column:39},end:{line:5,column:46}}}):c)+'" \r\n  tabindex="'+(null!=(s=__default(o(6088)).call(l,null!=e?h(e,"pos"):e,0,{name:"ifeq",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r,loc:{start:{line:6,column:12},end:{line:6,column:37}}}))?s:"")+(null!=(s=__default(o(20884)).call(l,null!=e?h(e,"pos"):e,0,{name:"ifneq",hash:{},fn:t.program(3,r,0),inverse:t.noop,data:r,loc:{start:{line:6,column:37},end:{line:6,column:65}}}))?s:"")+'" src="'+u(typeof(c=null!=(c=h(i,"url")||(null!=e?h(e,"url"):e))?c:a)===d?c.call(l,{name:"url",hash:{},data:r,loc:{start:{line:6,column:72},end:{line:6,column:79}}}):c)+'"/>'},useData:!0})},16492:(t,e,o)=>{"use strict";o.d(e,{x:()=>Widget});var i=o(7181),n=o(40561);function Widget(t){const e=i.Ay.get(n.default);return function(o){console.debug("Registering widget "+o.name+" for selector "+t.selector),e.registerWidget(t.selector,o)}}},19412:(t,e,o)=>{"use strict";o.d(e,{A:()=>Element});var i=o(16126),n=o(3605);class Element{constructor(t,e,o,i){this.voiceControl=t,this.utils=e,this.i18n=o,this.alert=i,this._activityNumber=0,this._preload=!1}async init(){if(!this._widget)throw new Error("ElementHTML widget has not been set.");this.voiceControlButton&&(this.voiceControlButton.addEventListener("click",(()=>{if(this.voiceControl.currentTarget!==this.id){for(;this.voiceControl.numTargets>1;)this.voiceControl.popTarget();return this._parent&&this.voiceControl.addTarget(this._parent.id),void this.voiceControl.addTarget(this.id)}this.voiceControl.popTarget(),this.voiceControlButton&&this.toggleVoiceControlButton(!1)})),this.voiceControl.voiceControlTargetChanged.subscribe((t=>{this.id===t.old&&this.toggleVoiceControlButton(!1),this.id===t.new&&this.toggleVoiceControlButton(!0)})),this.voiceControl.voiceControlActions.pipe((0,i.p)((t=>t.target===this.id))).subscribe((t=>{console.debug(`[Element] Element with ${this.id} received voice action:`,t),t instanceof n.m6?this.voiceControlStart():t instanceof n.$q?this.voiceControlFinish():t instanceof n.DZ?this.voiceControlNext():t instanceof n.vZ?this.voiceControlPrevious():t instanceof n.Fd?this.voiceControlGoto(t.position):t instanceof n.V3?this.voiceControlBack():t instanceof n.gZ?this.voiceControlSelect():t instanceof n.CG?this.voiceControlClose():t instanceof n.sT?this.voiceControlCheck():t instanceof n.XR?this.voiceControlCurrent():t instanceof n.B$?this.voiceControlDelete():t instanceof n._R?this.voiceControlMaximize():t instanceof n.EZ?this.voiceControlMinimize():t instanceof n.$V?this.voiceControlMove(t.position):t instanceof n.ow?this.voiceControlPause():t instanceof n.OR?this.voiceControlPlay():t instanceof n.pr?this.voiceControlRepeat():t instanceof n.lR?this.voiceControlReset():t instanceof n.m6?this.voiceControlStart():t instanceof n.o3?this.voiceControlStop():t instanceof n.HU?this.voiceControlWrite(t.text):t instanceof n.kw&&this.voiceControlUnknown()})))}get description(){return this.widget.dataset.desc||""}get id(){return this.widget.id}get type(){return this.widget.dataset.type||""}get widget(){return this._widget}set widget(t){this._widget=t}get parent(){return this._parent}set parent(t){this._parent=t}get preload(){return this._preload}get voiceControlButton(){return this._voiceControlButton||(this._voiceControlButton=document.querySelector(`#speech-to-action-${this.id}`)),this._voiceControlButton}set activityNumber(t){this._activityNumber=t,this.voiceControlButton&&(this.voiceControlButton.innerHTML+=`<span class="element-number">${this.i18n.value("activity-number",{num:t})}</span>`)}toggleHighlight(t){this.widget.classList.toggle("speech-focused",t)}toggleVoiceControlButton(t){if(this.voiceControlButton){const e=this.voiceControlButton.querySelector("svg");e&&(e.classList.toggle("fa-head-side-cough",t),e.classList.toggle("fa-head-side-cough-slash",!t))}}showVoiceControlButton(){this.voiceControlButton&&this.voiceControlButton.classList.add("show")}hideVoiceControlButton(){this.voiceControlButton&&this.voiceControlButton.classList.remove("show")}voiceControlStart(){this.toggleVoiceControlButton(!0)}voiceControlFinish(){this.voiceControl.popTarget(),this.toggleVoiceControlButton(!1)}voiceControlClose(){this.voiceControlUnknown()}voiceControlCheck(){this.voiceControlUnknown()}voiceControlCurrent(){this.voiceControlUnknown()}voiceControlDelete(){this.voiceControlUnknown()}voiceControlMaximize(){this.voiceControlUnknown()}voiceControlMinimize(){this.voiceControlUnknown()}voiceControlMove(t){this.voiceControlUnknown()}voiceControlPause(){this.voiceControlUnknown()}voiceControlPlay(){this.voiceControlUnknown()}voiceControlRepeat(){this.voiceControlUnknown()}voiceControlReset(){this.voiceControlUnknown()}voiceControlStop(){this.voiceControlUnknown()}voiceControlWrite(t){this.voiceControlUnknown()}voiceControlNext(){this.voiceControlUnknown()}voiceControlPrevious(){this.voiceControlUnknown()}voiceControlGoto(t){this.voiceControlUnknown()}voiceControlBack(){this.voiceControlUnknown()}voiceControlSelect(){this.voiceControlUnknown()}voiceControlUnknown(){this.alert.danger(this.i18n.vc.value("message.error"))}}},11867:(t,e,o)=>{"use strict";var i,n;o.d(e,{A:()=>s}),function(t){t[t.TERMS=0]="TERMS",t[t.OPTIONS=1]="OPTIONS"}(i||(i={})),function(t){t.ARROW_LEFT="ArrowLeft",t.ARROW_UP="ArrowUp",t.ARROW_RIGHT="ArrowRight",t.ARROW_DOWN="ArrowDown",t.END="End",t.ENTER="Enter",t.ESCAPE="Escape",t.HOME="Home",t.SPACE="Space"}(n||(n={}));var r=o(19412);class PuzzleElement extends r.A{constructor(t,e,o,i,n){super(o,t,i,n),this.utils=t,this.bootstrap=e,this.voiceControl=o,this.i18n=i,this.alert=n}onKeyDownInput(t,e){if(!Object.values(n).includes(t))return!1;const o=e.closest(".dropdown").querySelector(".dropdown-menu"),i=Array.from(this.widget.querySelectorAll(".piece"));let r=i.indexOf(e);return t===n.ARROW_LEFT||t===n.ARROW_RIGHT||t===n.HOME||t===n.END?(i.forEach((t=>t.setAttribute("tabindex","-1"))),t===n.ARROW_LEFT&&(r=this.utils.mod(r-1,i.length)),t===n.ARROW_RIGHT&&(r=this.utils.mod(r+1,i.length)),t===n.HOME&&(r=0),t===n.END&&(r=i.length-1),i[r].setAttribute("tabindex","0"),i[r].focus()):t===n.ARROW_UP?(this.dropDownModule.getOrCreateInstance(e).show(),setTimeout((()=>{const t=Array.from(o.querySelectorAll(".clip-link"));t[t.length-1].focus()}),PuzzleElement.FOCUS_DELAY_MS)):t===n.ARROW_DOWN||t===n.ENTER||t===n.SPACE?(this.dropDownModule.getOrCreateInstance(e).show(),setTimeout((()=>{Array.from(o.querySelectorAll(".clip-link"))[0].focus()}),PuzzleElement.FOCUS_DELAY_MS)):t===n.ESCAPE&&e.blur(),!0}dropItem(t){if(this.grabbed){const e=this.grabbed.closest(".dropdown");e.parentElement.innerHTML="",t.append(e),this.grabbed.setAttribute("aria-grabbed","false"),this.grabbed.focus(),this.grabbed=null}this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder").forEach((t=>t.setAttribute("aria-dropeffect","")))}dragItem(t){Array.from(this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder")).filter((t=>""===t.innerHTML)).forEach((t=>t.setAttribute("aria-dropeffect","move"))),this.grabbed&&this.grabbed.setAttribute("aria-grabbed","false"),this.grabbed=t,this.grabbed.setAttribute("aria-grabbed","true")}resizeSVG(){const t=this.layer.getAttribute("viewBox");if(t){const e=parseInt(t.split(" ")[2]),o=this.layer.clientWidth,i=Array.from(this.layer.querySelectorAll(".clip-placeholder"));let n=e/o,r=Math.min(...i.map((t=>t.clientWidth))),s=Math.min(...i.map((t=>t.clientHeight))),c=Math.min(r,s);this.layer.querySelectorAll(".clip-text").forEach((t=>{t.style.fontSize=Math.min(c,Math.round(30*n))+"px"})),this.layer.querySelectorAll(".clip-text-circle").forEach((t=>{t.setAttribute("r",Math.min(c/2,Math.round(24*n)).toString()),t.style.strokeWidth=Math.round(2*n)+"px"}))}}async init(){await super.init(),this.dropDownModule=await this.bootstrap.loadDropdownModule(),this.background=this.widget.querySelector(".puzzle-background"),this.layer=this.widget.querySelector(".interactive-layer"),window.addEventListener("resize",(()=>this.resizeSVG())),this.widget.addEventListener("dragstart",(t=>{t.target instanceof HTMLElement&&t.target.closest(".piece")&&this.dragItem(t.target.closest(".piece"))})),this.widget.addEventListener("keydown",(t=>{if(t.target instanceof HTMLElement){const e=t.target.closest(".piece[data-bs-toggle]");e&&this.onKeyDownInput(t.code,e)&&t.preventDefault()}})),this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder").forEach((t=>{t.addEventListener("dragover",(e=>{null===t.querySelector(".piece")&&(e.dataTransfer.dropEffect="move",e.preventDefault())})),t.addEventListener("drop",(t=>this.dropItem(t.target)))})),this.widget.addEventListener("click",(t=>{if(t.target instanceof HTMLElement)if(t.target.classList.contains("btn-check-answer"))this.check();else if(t.target.classList.contains("btn-reset"))this.reset();else if(t.target.classList.contains("clip-link")){t.preventDefault();const e=t.target.dataset.pos,o=this.widget.querySelector(`.piece-wrapper[data-pos="${e}"]`),i=o.querySelector(".piece");if(i){const t=Array.from(this.widget.querySelectorAll(".piece-placeholder")).find((t=>""===t.innerHTML));t&&t.append(i.closest(".dropdown"))}setTimeout((()=>this.dropItem(o)),1)}else{const e=t.target.closest(".piece");if(e){const t=e.closest(".dropdown").querySelector(".clip-link");setTimeout((()=>t.focus()),PuzzleElement.FOCUS_DELAY_MS)}}})),this.widget.addEventListener("show.bs.dropdown",(t=>{if(t.target instanceof HTMLElement&&t.target.classList.contains("dropdown")){const e=t.target.closest("foreignObject");e&&this.layer.append(e)}})),this.widget.addEventListener("shown.bs.dropdown",(t=>{if(t.target instanceof HTMLElement){const e=t.target.closest(".dropdown");e&&this.dragItem(e.querySelector(".piece"))}})),this.widget.addEventListener("hidden.bs.dropdown",(t=>{if(t.target instanceof HTMLElement&&t.target.classList.contains("dropdown")){t.target.querySelector(".piece").setAttribute("aria-grabbed","false"),this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder").forEach((t=>t.setAttribute("aria-dropeffect","")))}}))}voiceControlCheck(){this.check()}voiceControlGoto(t){const e=null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece"));e[this.utils.mod(t,e.length)].focus()}voiceControlMove(t){if(null!==this.widget.querySelector(".dropdown-menu.show"))return;const e=this.widget.querySelector('.piece-wrapper[data-pos="'+t+'"]');if(!e)return void this.voiceControlUnknown();const o=e.querySelector(".piece");if(o){const t=Array.from(this.widget.querySelectorAll(".piece-placeholder")).find((t=>""===t.innerHTML));t&&t.append(o.closest(".dropdown"))}const i=Array.from(this.widget.querySelectorAll(".piece")),n=i.find((t=>t===document.activeElement))||i[0];this.grabbed=n,setTimeout((()=>this.dropItem(e)),1)}voiceControlNext(){const t=null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece")),e=t.find((t=>t===document.activeElement));if(e){const o=t.indexOf(e);t[this.utils.mod(o+1,t.length)].focus()}else t[0].focus()}voiceControlPrevious(){const t=null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece")),e=t.find((t=>t===document.activeElement));if(e){const o=t.indexOf(e);t[this.utils.mod(o-1,t.length)].focus()}else t[t.length-1].focus()}voiceControlSelect(){const t=(null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece"))).find((t=>t===document.activeElement));t&&t.click()}voiceControlStart(){super.voiceControlStart(),this.voiceControlGoto(0)}voiceControlRepeat(){const t=null!==this.widget.querySelector(".dropdown-menu.show");this.alert.info(this.i18n.vc.value("info.puzzle."+(t?"options":"terms")))}voiceControlReset(){this.reset()}}PuzzleElement.FOCUS_DELAY_MS=100;const s=PuzzleElement},35999:(t,e,o)=>{"use strict";o.d(e,{A:()=>l});var i=o(65360),n=o(27291),r=o(16126),s=o(81160),__decorate=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let c=class InteractionService{constructor(){this.interactionSubject=new n.B,this.interactions$=this.interactionSubject.asObservable()}getInteractions(t){return this.interactions$.pipe((0,r.p)((e=>e instanceof t)),(0,s.T)((t=>t)))}emit(t){console.debug("Interaction sent",t),this.interactionSubject.next(t)}};c=__decorate([(0,i.k)({global:!0}),__metadata("design:paramtypes",[])],c);const l=c},75015:(t,e,o)=>{"use strict";o.d(e,{HB:()=>VideoReadyInteraction,Hc:()=>VideoEndInteraction,Pm:()=>TabClickedInteraction,SB:()=>VideoPlayingInteraction,Ym:()=>VideoPauseInteraction,fy:()=>AudioPauseInteraction,gY:()=>VideoMaximizedInteraction,nz:()=>ActivityResetInteraction,pK:()=>AudioPlayInteraction,ro:()=>AudioStopInteraction,s9:()=>VideoMinimizedInteraction,sV:()=>ActivityCheckInteraction,uX:()=>VideoPlayInteraction,yz:()=>ActivityFinishedInteraction});class Interaction{constructor(t){this._widgetId=t.id,this._widgetType=t.type,this._widgetDescription=t.description}get id(){return this._widgetId}get type(){return this._widgetType}get description(){return this._widgetDescription}}class ActivityResetInteraction extends Interaction{}class ActivityCheckInteraction extends Interaction{constructor(t){super(t),this._score=t.score}get score(){return this._score}}class ActivityFinishedInteraction extends Interaction{}class TabClickedInteraction extends Interaction{constructor(t){super(t),this._tab=t.tab}get tab(){return this._tab}}class AudioPlayInteraction extends Interaction{}class AudioPauseInteraction extends Interaction{}class AudioStopInteraction extends Interaction{}class VideoInteraction extends Interaction{constructor(t){super(t),this._time=t.time,this._duration=t.duration}get time(){return this._time}get duration(){return this._duration}}class VideoPlayInteraction extends VideoInteraction{}class VideoPlayingInteraction extends VideoInteraction{}class VideoEndInteraction extends VideoInteraction{}class VideoPauseInteraction extends VideoInteraction{}class VideoReadyInteraction extends Interaction{}class VideoMaximizedInteraction extends Interaction{}class VideoMinimizedInteraction extends Interaction{}},6088:(t,e,o)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(t,e,o){if(t==e)return o.fn(this)}o.r(e),o.d(e,{default:()=>__WEBPACK_DEFAULT_EXPORT__})},20884:(t,e,o)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(t,e,o){if(t!=e)return o.fn(this)}o.r(e),o.d(e,{default:()=>__WEBPACK_DEFAULT_EXPORT__})}}]);