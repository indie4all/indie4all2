(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[30703,25715,93113],{75220:(t,e,n)=>{var i=n(93633);t.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var s,r=null!=e?e:t.nullContext||{},a=t.hooks.helperMissing,l="function",c=t.escapeExpression,d=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="note new" draggable="true" data-time="'+c(typeof(s=null!=(s=d(n,"id")||(null!=e?d(e,"id"):e))?s:a)===l?s.call(r,{name:"id",hash:{},data:o,loc:{start:{line:1,column:50},end:{line:1,column:56}}}):s)+'" style="position: absolute; inset: '+c(typeof(s=null!=(s=d(n,"position")||(null!=e?d(e,"position"):e))?s:a)===l?s.call(r,{name:"position",hash:{},data:o,loc:{start:{line:1,column:92},end:{line:1,column:104}}}):s)+'; height: 8.125rem;">\r\n  <a href="javascript:;" class="button maximize"><i class="far fa-window-maximize"></i></a>\r\n  <a href="javascript:;" class="button remove"><i class="fas fa-times"></i></a>\r\n  <div class="note_cnt">\r\n    <textarea class="title" placeholder="'+c(typeof(s=null!=(s=d(n,"titlePlaceholder")||(null!=e?d(e,"titlePlaceholder"):e))?s:a)===l?s.call(r,{name:"titlePlaceholder",hash:{},data:o,loc:{start:{line:5,column:41},end:{line:5,column:61}}}):s)+'">'+c(typeof(s=null!=(s=d(n,"title")||(null!=e?d(e,"title"):e))?s:a)===l?s.call(r,{name:"title",hash:{},data:o,loc:{start:{line:5,column:63},end:{line:5,column:72}}}):s)+'</textarea>\r\n    <textarea class="description" placeholder="'+c(typeof(s=null!=(s=d(n,"descriptionPlaceholder")||(null!=e?d(e,"descriptionPlaceholder"):e))?s:a)===l?s.call(r,{name:"descriptionPlaceholder",hash:{},data:o,loc:{start:{line:6,column:47},end:{line:6,column:73}}}):s)+'" hidden>'+c(typeof(s=null!=(s=d(n,"description")||(null!=e?d(e,"description"):e))?s:a)===l?s.call(r,{name:"description",hash:{},data:o,loc:{start:{line:6,column:82},end:{line:6,column:97}}}):s)+"</textarea>\r\n  </div>\r\n</div>"},useData:!0})},39492:(t,e,n)=>{var i=n(93633);t.exports=(i.default||i).template({1:function(t,e,n,i,o){var s,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'        <a class="nav-element current" href="#" data-bs-dismiss="offcanvas" aria-current="page">\r\n            <i class="fa-solid fa-location-dot"></i>'+t.escapeExpression("function"==typeof(s=null!=(s=r(n,"title")||(null!=e?r(e,"title"):e))?s:t.hooks.helperMissing)?s.call(null!=e?e:t.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:5,column:52},end:{line:5,column:61}}}):s)+"\r\n        </a>\r\n"},3:function(t,e,n,i,o){var s,r=null!=e?e:t.nullContext||{},a=t.hooks.helperMissing,l="function",c=t.escapeExpression,d=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'        <a class="nav-element" href="'+c(typeof(s=null!=(s=d(n,"url")||(null!=e?d(e,"url"):e))?s:a)===l?s.call(r,{name:"url",hash:{},data:o,loc:{start:{line:8,column:37},end:{line:8,column:44}}}):s)+'">'+c(typeof(s=null!=(s=d(n,"title")||(null!=e?d(e,"title"):e))?s:a)===l?s.call(r,{name:"title",hash:{},data:o,loc:{start:{line:8,column:46},end:{line:8,column:55}}}):s)+"</a>\r\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var s,r,a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,c="function",d=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"<li>\r\n    <h"+d(typeof(r=null!=(r=u(n,"level")||(null!=e?u(e,"level"):e))?r:l)===c?r.call(a,{name:"level",hash:{},data:o,loc:{start:{line:2,column:6},end:{line:2,column:15}}}):r)+' class="related-entry related-unit">\r\n'+(null!=(s=u(n,"if").call(a,null!=e?u(e,"current"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.program(3,o,0),data:o,loc:{start:{line:3,column:8},end:{line:9,column:15}}}))?s:"")+"    </h"+d(typeof(r=null!=(r=u(n,"level")||(null!=e?u(e,"level"):e))?r:l)===c?r.call(a,{name:"level",hash:{},data:o,loc:{start:{line:10,column:7},end:{line:10,column:16}}}):r)+">\r\n</li>"},useData:!0})},51941:(t,e,n)=>{var i=n(93633);t.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var s,r,a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,c="function",d=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<li>\r\n    <h3 class="related-entry related-group">'+t.escapeExpression(typeof(r=null!=(r=d(n,"title")||(null!=e?d(e,"title"):e))?r:l)===c?r.call(a,{name:"title",hash:{},data:o,loc:{start:{line:2,column:44},end:{line:2,column:53}}}):r)+'</h3>\r\n    <ol class="related-group-content">\r\n        '+(null!=(s=typeof(r=null!=(r=d(n,"content")||(null!=e?d(e,"content"):e))?r:l)===c?r.call(a,{name:"content",hash:{},data:o,loc:{start:{line:4,column:8},end:{line:4,column:21}}}):r)?s:"")+"\r\n    </ol>\r\n</li>"},useData:!0})},35999:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var i=n(65360),o=n(27291),s=n(16126),r=n(81160),__decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let a=class InteractionService{constructor(){this.interactionSubject=new o.B,this.interactions$=this.interactionSubject.asObservable()}getInteractions(t){return this.interactions$.pipe((0,s.p)((e=>e instanceof t)),(0,r.T)((t=>t)))}emit(t){console.debug("Interaction sent",t),this.interactionSubject.next(t)}};a=__decorate([(0,i.k)({global:!0}),__metadata("design:paramtypes",[])],a);const l=a},75015:(t,e,n)=>{"use strict";n.d(e,{HB:()=>VideoReadyInteraction,Hc:()=>VideoEndInteraction,Pm:()=>TabClickedInteraction,SB:()=>VideoPlayingInteraction,Ym:()=>VideoPauseInteraction,fy:()=>AudioPauseInteraction,gY:()=>VideoMaximizedInteraction,nz:()=>ActivityResetInteraction,pK:()=>AudioPlayInteraction,ro:()=>AudioStopInteraction,s9:()=>VideoMinimizedInteraction,sV:()=>ActivityCheckInteraction,uX:()=>VideoPlayInteraction,yz:()=>ActivityFinishedInteraction});class Interaction{constructor(t){this._widgetId=t.id,this._widgetType=t.type,this._widgetDescription=t.description}get id(){return this._widgetId}get type(){return this._widgetType}get description(){return this._widgetDescription}}class ActivityResetInteraction extends Interaction{}class ActivityCheckInteraction extends Interaction{constructor(t){super(t),this._score=t.score}get score(){return this._score}}class ActivityFinishedInteraction extends Interaction{}class TabClickedInteraction extends Interaction{constructor(t){super(t),this._tab=t.tab}get tab(){return this._tab}}class AudioPlayInteraction extends Interaction{}class AudioPauseInteraction extends Interaction{}class AudioStopInteraction extends Interaction{}class VideoInteraction extends Interaction{constructor(t){super(t),this._time=t.time,this._duration=t.duration}get time(){return this._time}get duration(){return this._duration}}class VideoPlayInteraction extends VideoInteraction{}class VideoPlayingInteraction extends VideoInteraction{}class VideoEndInteraction extends VideoInteraction{}class VideoPauseInteraction extends VideoInteraction{}class VideoReadyInteraction extends Interaction{}class VideoMaximizedInteraction extends Interaction{}class VideoMinimizedInteraction extends Interaction{}},93113:(t,e,n)=>{"use strict";n.d(e,{default:()=>l});var i=n(65360),o=n(75015),s=n(27291),r=n(35999),__decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let a=class ObjectivesService{constructor(t){this.interaction=t,this.objectivesSubject=new s.B,this.objectivesEvent$=this.objectivesSubject.asObservable(),t.getInteractions(o.Pm).subscribe((t=>{this.objectivesSubject.next({id:t.id+t.tab,type:t.type,description:t.description})})),t.getInteractions(o.yz).subscribe((t=>{this.objectivesSubject.next({id:t.id,type:t.type,description:t.description})})),t.getInteractions(o.pK).subscribe((t=>{this.objectivesSubject.next({id:t.id,type:t.type,description:t.description})})),t.getInteractions(o.Hc).subscribe((t=>{this.objectivesSubject.next({id:t.id,type:t.type,description:t.description})}))}get events(){return this.objectivesEvent$}};a=__decorate([(0,i.k)({global:!0}),__metadata("design:paramtypes",[r.A])],a);const l=a},25715:(t,e,n)=>{"use strict";n.d(e,{default:()=>a});var i=n(65360),o=n(93113),s=n(7979),__decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let r=class ProgressService{constructor(t,e){this.objService=t,this.bootstrap=e}markObjectiveAsCompleted(t){const e=document.getElementById(t);e&&(e.classList.add("fas"),e.classList.remove("far"))}redraw(){requestAnimationFrame((()=>{this.progressBars.forEach(((t,e)=>{if(!(0!=this.objectives[e].length))return t.innerHTML="",t.setAttribute("aria-valuenow","100"),void(t.style.width="100%");const n=Math.floor(this.objectives[e].reduce(((t,e)=>t+e.percentage),0)/this.objectives[e].length);t.innerHTML=`${n}%`,t.setAttribute("aria-valuenow",n.toString()),t.style.width=`${n}%`}))}))}async initMenu(){await this.bootstrap.loadCollapseModule(),this.redraw()}async init(){this.progressMenu=document.querySelector("#progreso_mp"),this.progressBars=Array.from(document.querySelectorAll(".progress-bar")),this.objectives=Array.from(document.querySelectorAll("section.container")).map((t=>Array.from(t.querySelectorAll(".objective")).map((t=>({id:t.id,percentage:0})))))}};r=__decorate([(0,i.k)({global:!0}),__metadata("design:paramtypes",[o.default,s.A])],r);const a=r},30703:(t,e,n)=>{"use strict";n.d(e,{default:()=>w});var i=n(65360),o=n(87079),s=n(7979),r=n(75220),a=n.n(r),l=n(83034),__decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let c=class AnnotationsService{constructor(t,e){this.bootstrap=t,this.i18n=e,this.currentColor="transparent",this.currentZIndex=1,this.notes=[]}async initHighlighter(t){const{default:e}=await n.e(46045).then(n.bind(n,46045));this.popoverModule=await this.bootstrap.loadPopoverModule(),this.highlighter=new e(document.body,{version:"primitivo",color:this.currentColor,onAfterHighlight:async(t,e,n,i)=>{document.querySelectorAll('span[data-timestamp="'+n+'"]').forEach((t=>{const e=document.createElement("i");e.classList.add("fas","fa-trash-alt","fa-2x"),e.id=n,t.setAttribute("tabindex","0"),t.dataset.bsToggle="popover",t.dataset.bsContent=e.outerHTML,t.dataset.bsPlacement="top",t.dataset.bsHtml="true",t.classList.add("non-selected"),this.popoverModule.getOrCreateInstance(t)}));const o=this.highlighter.serializeHighlights();localStorage.setItem(this.unitId,o)},onBeforeHighlight:t=>"transparent"!==this.currentColor}),t&&(this.highlighter.deserializeHighlights(t),document.querySelectorAll("span.highlighted").forEach((t=>this.popoverModule.getOrCreateInstance(t))))}async setHighlighter(t){this.highlighter||await this.initHighlighter(),this.colors.forEach((e=>{e.classList.toggle("selected",e===t),e.setAttribute("aria-pressed",e===t?"true":"false")}));const e=t.dataset.color;this.highlighter.setColor(e),this.currentColor=e}async removeHighlights(t){if(this.highlighter||await this.initHighlighter(),!t)return this.highlighter.removeHighlights(),localStorage.removeItem(this.unitId),void document.querySelectorAll(".popover").forEach((t=>t.remove()));document.querySelectorAll(`span[data-timestamp="${t}"]`).forEach((t=>{this.highlighter.removeHighlights(t)}));const e=this.highlighter.serializeHighlights();localStorage.setItem(this.unitId,e),document.getElementById(t).closest(".popover").remove()}async loadHighlights(t){this.highlighter||await this.initHighlighter(),this.highlighter.removeHighlights(),localStorage.setItem(this.unitId,t),this.highlighter.deserializeHighlights(t),document.querySelectorAll("span.highlighted").forEach((t=>this.popoverModule.getOrCreateInstance(t)))}addNote(t){const e=this.i18n.value("note.input.title"),n=this.i18n.value("note.input.description"),i=t.id,o=t.position||"calc("+window.scrollY+"px + 25%) 0 300px calc(50% - 100px)",s=t.title||"",r=t.description||"",l=a()({id:i,position:o,title:s,description:r,titlePlaceholder:e,descriptionPlaceholder:n});document.body.insertAdjacentHTML("beforeend",l),this.notes.push(t),localStorage.setItem(this.unitId+"-note",JSON.stringify(this.notes));const c=document.querySelector(`.note[data-time="${i}"]`);c.style.zIndex=++this.currentZIndex+"";const d=c.querySelector("textarea.description"),u=c.querySelector("textarea.title");requestAnimationFrame((()=>{c.classList.remove("new")})),c.addEventListener("click",(e=>{if(e.target instanceof Element){const n=e.target.closest(".button");if(!n)return;if(n.classList.contains("remove"))this.notes.splice(this.notes.indexOf(t),1),0===this.notes.length?localStorage.removeItem(this.unitId+"-note"):localStorage.setItem(this.unitId+"-note",JSON.stringify(this.notes)),c.remove();else if(n.classList.contains("maximize")||n.classList.contains("minimize")){const t=n.classList.contains("minimize");n.classList.toggle("minimize",!t),n.classList.toggle("maximize",t),n.innerHTML=t?'<i class="far fa-window-maximize"></i>':'<i class="far fa-window-minimize"></i>',c.style.height=t?"8.75rem":"18.75rem",c.style.maxHeight=t?"8.75rem":"18.75rem",u.style.maxHeight="4rem",u.style.minHeight="4rem",d.hidden=t}}})),u.addEventListener("change",(()=>{t.title=u.value,localStorage.setItem(this.unitId+"-note",JSON.stringify(this.notes))})),d.addEventListener("change",(()=>{t.description=d.value,localStorage.setItem(this.unitId+"-note",JSON.stringify(this.notes))}));let h=0,p=0,f=0,m=0;const mousemove=t=>{t.preventDefault(),f=h-t.clientX,m=p-t.clientY,h=t.clientX,p=t.clientY,c.style.left=c.offsetLeft-f+"px",c.style.top=c.offsetTop-m+"px"},mouseup=e=>{e.preventDefault(),t.position=c.style.inset,localStorage.setItem(this.unitId+"-note",JSON.stringify(this.notes)),document.removeEventListener("mousemove",mousemove),document.removeEventListener("mouseup",mouseup),c.classList.remove("dragging")};c.addEventListener("mousedown",(t=>{t.target instanceof HTMLElement&&(t.target.classList.contains("note")||t.target.classList.contains("note_cnt"))&&(t.preventDefault(),h=t.clientX,p=t.clientY,c.style.zIndex=++this.currentZIndex+"",document.addEventListener("mousemove",mousemove),document.addEventListener("mouseup",mouseup),c.classList.add("dragging"))}))}newNote(){this.addNote({id:Date.now().toString(),title:"",description:"",position:""})}async loadNotes(t){JSON.parse(t).forEach((t=>this.addNote(t)))}loadAnnotations(t){const e=new FileReader;e.onload=async e=>{try{const n=JSON.parse(e.target.result);n.highlights&&await this.loadHighlights(n.highlights),n.notes&&this.loadNotes(n.notes),t.value=""}catch(t){console.error("Error loading annotations",t)}},e.readAsText(t.files[0])}downloadAnnotations(){const t=localStorage.getItem(this.unitId+"-note"),e=localStorage.getItem(this.unitId),n=new File([JSON.stringify({notes:t,highlights:e},null,2)],`notes-${this.unitId}.json`,{type:"application/json"}),i=document.createElement("a"),o=URL.createObjectURL(n);i.href=o,i.download=n.name,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(o)}async initMenu(){var t;await this.bootstrap.loadCollapseModule(),this.colors=Array.from(document.querySelectorAll(".highlight-color")),document.addEventListener("click",(t=>{t.target instanceof HTMLElement&&(this.colors.includes(t.target)?this.setHighlighter(t.target):t.target.closest(".highlight-delete")?this.removeHighlights():t.target.closest("#upload-notes")?document.getElementById("upload-file-notes").click():t.target.closest("#download-notes")?this.downloadAnnotations():t.target.closest("#add_new")&&this.newNote())})),null===(t=document.getElementById("upload-file-notes"))||void 0===t||t.addEventListener("change",(t=>this.loadAnnotations(t.target)))}async init(t){this.unitId=t;const e=localStorage.getItem(this.unitId);e&&await this.initHighlighter(e);const n=localStorage.getItem(this.unitId+"-note");n&&this.loadNotes(n),document.addEventListener("mouseover",(t=>{if(t.target instanceof HTMLElement){const e=t.target.closest("span.highlighted");e&&(e.style.cursor="pointer")}})),document.addEventListener("click",(t=>{t.target instanceof Element&&t.target.closest(".fa-trash-can")&&this.removeHighlights(t.target.id)})),document.addEventListener("keyup",(t=>{if(t.target instanceof HTMLElement){const e=t.target.closest("span.highlighted");e&&"Delete"===t.key&&this.removeHighlights(e.dataset.timestamp)}}))}};c=__decorate([(0,i.k)(),__metadata("design:paramtypes",[s.A,l.A])],c);const d=c;var u=n(25715);var h=n(51941),p=n.n(h),f=n(39492),m=n.n(f),related_units_service_decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},related_units_service_metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let g=class RelatedUnitsService{constructor(t){this.bootstrap=t,this.ALLOWED_HOSTS="opencontent.upct.es,contentserver.upct.es".split(","),this.ALLOWED_ORIGIN_PARAMETERS="indieopen,indieupct".split(",")}async parseCurrentRelatedUnits(){try{const t=await fetch("related_units.json");return t.ok?{type:"current",...await t.json()}:null}catch(t){return null}}async parseRefererRelatedUnits(t){try{const e=new URL(t),n=`${(e.origin+e.pathname).replace(/\/$/,"")}/related_units.json`;if(e&&(e.hostname===window.location.hostname||this.ALLOWED_HOSTS.includes(e.hostname))){const t=await fetch(n);if(t.ok)return{type:"referer",...await t.json()}}return null}catch(t){return null}}unit(t,e){if("#"===t.url){if("current"===this.content.type)return m()({title:t.title,current:!0,level:e});let n=this.refererURL.origin+this.refererURL.pathname+"?";return this.refererURL.searchParams.has("vt")&&(n+=`&vt=${this.refererURL.searchParams.get("vt")}`),this.refererURL.searchParams.has("origin")&&this.ALLOWED_ORIGIN_PARAMETERS.includes(this.refererURL.searchParams.get("origin"))&&(n+="&origin="+this.currentURL.searchParams.get("origin")),m()({title:t.title,current:!1,level:e,url:n})}const n=new URL(t.url);let i=n.hostname;this.ALLOWED_HOSTS.includes(i)&&!window.location.pathname.includes("preview")&&this.ALLOWED_HOSTS.includes(window.location.hostname)&&(i=window.location.hostname);let o=n.protocol+"//"+i+n.pathname;const s=o===window.location.origin+window.location.pathname;if(s)return m()({title:t.title,current:s,level:e});o+="?";const r="current"===this.content.type?this.currentURL:this.refererURL;let a=r.origin+r.pathname+"?";return r.searchParams.has("vt")&&(a+=`&vt=${r.searchParams.get("vt")}`),r.searchParams.has("origin")&&this.ALLOWED_ORIGIN_PARAMETERS.includes(r.searchParams.get("origin"))&&(a+="&origin="+r.searchParams.get("origin"),o+="&origin="+r.searchParams.get("origin")),m()({title:t.title,current:s,level:e,url:`${o}&ref=${encodeURIComponent(a)}`})}group(t){return p()({title:t.title,content:t.entries.map((t=>this.unit(t,4))).join("")})}async init(){const t=new URLSearchParams(window.location.search);if(t.has("ref")&&(this.content=await this.parseRefererRelatedUnits(t.get("ref"))),this.content||(this.content=await this.parseCurrentRelatedUnits()),!this.content)return;this.currentURL=new URL(window.location.href),"referer"===this.content.type&&(this.refererURL=new URL(t.get("ref")));const e=this.content.entries.map((t=>function isRelatedUnitsGroup(t){return void 0!==t.entries}(t)?this.group(t):this.unit(t,3))).join("");document.getElementById("related-units-text").textContent=this.content.help,document.getElementById("related-units-button").setAttribute("title",this.content.help),document.getElementById("related-units-list").innerHTML=e,document.getElementById("related-units").classList.remove("d-none");const n=document.getElementById("offcanvas-related-units");n.addEventListener("show.bs.offcanvas",(function(){document.body.classList.add("related-units-offcanvas-open")})),n.addEventListener("hide.bs.offcanvas",(function(){document.body.classList.remove("related-units-offcanvas-open")})),this.offcanvasModule=await this.bootstrap.loadOffCanvasModule();this.offcanvasModule.getOrCreateInstance(n).show(),console.debug("[Related Units] Initialized")}};g=related_units_service_decorate([(0,i.k)({global:!0}),related_units_service_metadata("design:paramtypes",[s.A])],g);const y=g;var v=n(61709),b=n(92652),menu_open_decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},menu_open_metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let I=class OpenMenuService extends b.default{constructor(t,e,n,i,o,s){super(t,n,s),this.bootstrap=t,this.annotations=e,this.accessibility=n,this.progress=i,this.related=o,this.voiceControl=s}async showDownloadModelButton(){if(!(await fetch("model.json",{method:"HEAD"})).ok)return;const t=document.getElementById("download-model");t&&(t.addEventListener("click",(function(){const t=document.createElement("a");t.href="model.json",t.download=document.title+".json",document.body.appendChild(t),t.click(),document.body.removeChild(t)})),t.parentElement.classList.remove("d-none"))}async init(t){var e;await super.init(t),await this.annotations.init(t),await this.progress.init(),await this.related.init(),null===(e=document.getElementById("offcanvas-additional-options"))||void 0===e||e.addEventListener("show.bs.offcanvas",(async()=>{await this.annotations.initMenu(),await this.showDownloadModelButton(),await this.progress.initMenu()}),{once:!0}),console.debug("[Menu] Content Menu initialized")}};I=menu_open_decorate([(0,i.k)(),menu_open_metadata("design:paramtypes",[s.A,d,o.A,u.default,y,v.A])],I);const w=I}}]);