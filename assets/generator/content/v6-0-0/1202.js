"use strict";(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[1202],{27171:(t,e,i)=>{i.d(e,{A:()=>RouletteElement});var n=i(46894),o=i(19412),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(o,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};class RouletteElement extends((0,n.A)(o.A)){constructor(t,e,i){super(t,e,i),this.voiceControl=t,this.utils=e,this.i18n=i}get questions(){return this._questions}init(){const t=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){yield t.init.call(this),this.spinner=this.widget.querySelector(".roulette-spin"),this.elementsToHideWhenQuestion=Array.from(this.widget.querySelectorAll(".container-roulette,.roulette-lifes,.roulette-heading")),this.categories=Array.from(this.widget.querySelectorAll(".roulette-category")),this.lifesContainer=this.widget.querySelector(".roulette-lifes"),this.circle=this.widget.querySelector(".roulette-circle"),this.lifes=Array.from(this.widget.querySelectorAll(".fa-heart")),this.widget.querySelector(".roulette-spinner-"+this.categories.length).classList.remove("d-none")}))}check(){}voiceControlRepeat(){this.voiceControlMessageElem.innerHTML+=this.utils.alert("alert-info",this.i18n.value("tta-info-containertest"))}voiceControlReset(){this.reset()}voiceControlSelect(){if(this.widget.querySelector(".roulette-spin").click(),this.currentQuestion){const t=this.children.find((t=>this.currentQuestion.contains(t.widget)));this.voiceControl.addTarget(t.id)}}}},90585:(t,e,i)=>{i.r(e),i.d(e,{default:()=>q});var n=i(65360),o=i(75015),s=i(3605),r=i(7979),a=i(24971),l=i(40561),c=i(97523),u=i(52176),h=i(44295),d=i(35999),m=i(37607),f=i(89953),g=i(27171),v=i(70583),y=i(61709),p=i(36097),w=i.n(p);const A=i.p+"../../../img/gamy-ok.avif",b=i.p+"../../../img/gamy-correct.avif",S=i.p+"../../../img/gamy-wrong.avif";var __decorate=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(o,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))};let C=class GamificationStudentUnit extends u.A{constructor(t,e,i,n,o,s,r,a,l,c){super(t,e,i,n,o,s,r,a,l),this.factory=t,this.menu=e,this.voiceControl=i,this.bootstrap=n,this.utils=o,this.i18n=s,this.code=r,this.gamification=a,this.mathjax=l,this.interaction=c}showActivitySent(){var t;const e=this.modalModule.getOrCreateInstance(this.modal);e.hide(),this.modal.querySelector(".modal-title").innerHTML=this.i18n.value("AnswerSent");const i=this.modal.querySelector(".modal-logo-img");i.src=A,i.alt=this.i18n.value("GamyGreeting"),this.modal.querySelector(".modal-title").innerHTML=this.i18n.value("AnswerSent"),null===(t=this.modal.querySelector(".gamification-ranking"))||void 0===t||t.remove(),e.show()}showScore(t){var e;t.forEach((t=>{t.points=Math.round(1e3*t.points),t.total=Math.round(1e3*t.total)}));const i=t.map(((t,e)=>t.id===this.gamification.user.id||e<=2?t:Object.assign(Object.assign({},t),{name:t.name.replace(/./g,"***")}))),n=this.modalModule.getOrCreateInstance(this.modal);n.hide(),this.modal.classList.add("changing"),null===(e=this.modal.querySelector(".gamification-ranking"))||void 0===e||e.remove();const o=i.find((t=>t.id===this.gamification.user.id)),s=(null==o?void 0:o.correct)?b:S,r=this.i18n.value((null==o?void 0:o.correct)?"TextCorrectAnswer":"TextIncorrectAnswer"),a=(null==o?void 0:o.correct)?this.i18n.value("GamyCorrect"):this.i18n.value("GamyWrong"),l=this.modal.querySelector(".modal-logo-img");if(l.src=s,l.alt=a,this.modal.querySelector(".modal-title").innerHTML=r,i.length){i.sort(((t,e)=>e.total-t.total));const t=w()({students:i,me:this.gamification.user});this.modal.querySelector(".modal-body").innerHTML+=t}setTimeout((()=>n.show()),500),setTimeout((()=>this.modal.classList.remove("changing")),1e3)}buildLogin(){if(this.gamification.user)return void window.location.replace("game.html");this.mathjax.init(),this.menu.init(this.id),this.code.init();const t=document.getElementById("select-username-form"),e=document.getElementById("input-username"),i=document.getElementById("btn-username");t.addEventListener("submit",(t=>{this.gamification.user={id:this.utils.generateUuid(),name:e.value||"Unknown"}})),this.voiceControl.voiceControlActions.subscribe((t=>{t instanceof s.m6?setTimeout((()=>e.focus()),100):t instanceof s.HU?e.value=t.text:t instanceof s.B$?e.value="":t instanceof s.gZ?i.click():t instanceof s.pr?document.getElementById("tta-message-global").innerHTML+=this.utils.alert("alert-info",this.i18n.value("tta-info-login")):t instanceof s.$q?(this.voiceControl.clearTargets(),this.voiceControl.stop()):document.getElementById("tta-message-global").innerHTML+=this.utils.alert("alert-danger",this.i18n.value("tta-error-message"))}))}init(){const t=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){document.body.classList.contains("login")?this.buildLogin():(yield t.init.call(this),this.interaction.getInteractions(o.sV).subscribe((t=>{this.activity instanceof g.A&&t.id!==this.activity.id||this.showActivitySent()})),yield this.gamification.init(),this.gamification.user?this.gamification.join():window.location.replace("index.html"))}))}};C=__decorate([(0,n.k)(),__metadata("design:paramtypes",[l.default,f.A,y.A,r.A,v.A,h.A,a.A,c.default,m.A,d.A])],C);const q=C}}]);