!function(){const o=io({forceNew:!0});var t=window.location.pathname.split("/");const i=t[t.length-2],a=i+"-username",s=i+"-uuid",d=i+"-date";let m=0,g=JSON.parse(sessionStorage.getItem(a));g||window.location.replace("index.html");let l=JSON.parse(sessionStorage.getItem(s))||([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));sessionStorage.setItem(s,JSON.stringify(l));let f=sessionStorage.getItem(d)||Date.now();o.emit("join-room",i,l,{username:g});function n(t,r){const c=$(document).find(".question-container").first();function n(i,s){function n(t){t.find(".gamification-ranking").remove();const e=function(t,i){t.sort((t,e)=>e.total-t.total);var e=t.map((t,e)=>2<e&&t!==i?{...t,username:"***"}:t).map(function(t,e){var n=$("<td />").html(e+1),a=$("<td />").html(t.username),o=$("<td />").html(t.points),e=$("<td />").html(t.total);return $("<tr />").toggleClass("current",t===i).append(n,a,o,e)}),n=$("<tr />").append($("<th />").attr("colspan",4).html(r("gamification-results"))),t=$("<tr />").append($("<th />").html(r("gamification-position")),$("<th />").html(r("gamification-username")),$("<th />").html(r("gamification-points")),$("<th />").html(r("gamification-total"))),t=$("<thead />").append(n,t),e=$("<tbody />").html(e);return $("<table/>").addClass("gamification-ranking table mx-auto").append(t,e)}(i,s);var n=s&&s.res?"https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-correct.png":"https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-wrong.png",a=s&&s.res?r("TextCorrectAnswer"):r("TextIncorrectAnswer"),o=s&&s.res?r("GamyCorrect"):r("GamyWrong");t.find(".modal-title").html(a),t.find(".modal-logo-img").attr("src",n).attr("alt",o),t.find(".modal-body").append(e),e.delay(1500).show(700),setTimeout(function(){t.removeClass("changing")},100)}const a=$("#gamification-message-modal");if(a.hasClass("show")){const o=bootstrap.Modal.getInstance(a[0]);a[0].addEventListener("hidden.bs.modal",function(){const t=a.clone();a.css("opacity",0),o.dispose(),a.remove(),t.addClass("changing"),n(t),bootstrap.Modal.getOrCreateInstance(t[0],{keyboard:!0,focus:!0,backdrop:!1}).show();const e=t[0].addEventListener("hidden.bs.modal",function(){c.focus(),t[0].removeEventListener("hidden.bs.modal",e)})}),o.hide()}else{a.addClass("changing"),n(a),bootstrap.Modal.getOrCreateInstance(a[0],{keyboard:!0,focus:!0,backdrop:!1}).show();const t=a[0].addEventListener("hidden.bs.modal",function(){c.focus(),a[0].removeEventListener("hidden.bs.modal",t)})}}o.on("ack",t=>{"number"==typeof t?.step&&(m=t.step,c.trigger("gamification-step",[m])),c.trigger("gamification-start-student",[t?.questions])}),o.on("next-activity",(t,e)=>{m=e,n(t,t.find(t=>t.id===l)),c.trigger("gamification-step",[m])}),o.on("stop-activity",()=>{$(".btn-gamification:visible").attr("disabled",!0)}),o.on("redirect-game-finished",t=>{sessionStorage.removeItem(a),sessionStorage.removeItem(s),sessionStorage.removeItem(d);var e=t.find(t=>t.id===l);n(t,e)}),$(document).on("gamificate",function(t,e,n){let a=$("#gamification-message-modal");a.find(".modal-title").html(r("AnswerSent")),a.find(".modal-logo-img").attr("src","https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-ok.png").attr("alt",r("GamyGreeting")),a.find(".gamification-ranking").remove(),bootstrap.Modal.getOrCreateInstance(a[0],{keyboard:!0,focus:!0,backdrop:!1}).show(),$(t.target).is(".btn-gamification")&&$(this).attr("disabled",!0),o.emit("question-response",{id:l,res:e,username:g,room:i,time:Date.now()-f,score:n,step:m})})}let r=document.currentScript.src;r=r.substr(0,r.lastIndexOf("/")),$(document).ready(function(){setTimeout(function(){$(".btn-gamification").attr("aria-haspopup","dialog")},500);let e=$("html").attr("lang");fetch(`${r}/../languages/${e}.json`).then(t=>t.json()).then(t=>i18next.createInstance({lng:e,resources:{[e]:{translation:t}}},n))})}();