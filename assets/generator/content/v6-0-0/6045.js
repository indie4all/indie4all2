"use strict";(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[6045],{46045:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f,findNodesAndOffsets:()=>findNodesAndOffsets});const i="data-highlighted",r="data-timestamp",s="data-start-offset",o="data-length",l=["SCRIPT","STYLE","SELECT","OPTION","BUTTON","OBJECT","APPLET","VIDEO","AUDIO","CANVAS","EMBED","PARAM","METER","PROGRESS"];function arrayToLower(e){return e.map(Function.prototype.call,String.prototype.toLowerCase)}function sortByDepth(e,t){e.sort((function(e,n){return a(t?n:e).parents().length-a(t?e:n).parents().length}))}function haveSameColor(e,t){return a(e).color()===a(t).color()}function createWrapper(e){let t=document.createElement("span");return t.style.backgroundColor=e.color,t.className=e.highlightedClass,t}function textContentExcludingTags(e,t){return a(e).textContentExcludingTags(arrayToLower(t))}function normaliseText(e){return e.replace(/((\r\n|\n\r|\n|\r)\s*)/g,"")}function normaliseOffset(e,t){const n=t.match(/^((\r\n|\n\r|\n|\r)\s*)/g);return n?e+n[0].length:e}function findNodesAndOffsets(e,t,n=l,i=!1){const r=[];let s=t,o=0;const g=e.offset+e.length;let d="";for(;s&&o<g;)if(n.includes(s.nodeName))s=a(s).nextClosestSibling(t);else{const l=textContentExcludingTags(s,n),c=i?normaliseText(l):"";s==t&&(d=i?c:l);const u=l.length,f=normaliseText(l).length,p=o+u,m=i?o+f:p;if(m>e.offset){if(0===s.childNodes.length){if(s.nodeType===h.TEXT_NODE){const t=e.offset>o?e.offset-o:0,n=i&&0===r.length?normaliseOffset(t,l):t,h=Math.abs(n-t),a=l.substr(n),d=i?a.length-normaliseText(a).length:0,c=p-h-d,f=g>=c?u-t:g-o-t+d,m=i&&0===r.length?f-h:f;m>0&&r.push({node:s,offset:n,length:m,normalisedText:i?normaliseText(s.textContent):s.textContent}),o=c}s=a(s).nextClosestSibling(t)}else s=s.childNodes[0]}else o=m,s=s!==t?s.nextSibling:null}return{nodesAndOffsets:r,allText:d}}function getElementOffset(e,t,n=l,i=!1,r=0,s=!1){let o,h=0,g=e;do{if(!n.includes(g.nodeName)){o=g.parentNode.childNodes;h+=getTextOffsetBefore(o,a(g.parentNode).getChildIndex(g),n,i)}g=g.parentNode}while(g!==t||!g);return i&&s?h:h+r}function getTextOffsetBefore(e,t,n,i=!1){let r=0;for(let s=0;s<t;s++){const t=e[s],o=a(t).textContentExcludingTags(arrayToLower(n));!n.includes(t.nodeName)&&o&&o.length>0&&(r+=i?normaliseText(o).length:o.length)}return r}function retrieveHighlights(e){let t=(e={andSelf:!0,grouped:!1,...e}).container.querySelectorAll("["+e.dataAttr+"]"),n=Array.prototype.slice.call(t);return!0===e.andSelf&&e.container.hasAttribute(e.dataAttr)&&n.push(e.container),e.grouped&&(n=function groupHighlights(e,t){let n=[],i={},r=[];return e.forEach((function(e){let r=e.getAttribute(t);void 0===i[r]&&(i[r]=[],n.push(r)),i[r].push(e)})),n.forEach((function(e){let t=i[e];r.push({chunks:t,timestamp:e,toString:function(){return t.map((function(e){return e.textContent})).join("")}})})),r}(n,e.timestampAttr)),n}function isElementHighlight(e,t){return e&&e.nodeType===h.ELEMENT_NODE&&e.hasAttribute(t)}function getHighlightedTextForRange(e,t=l){return a(e.cloneContents()).textContentExcludingTags(arrayToLower(t)).replace(/\s{2,}/g," ").replace("\r\n","").replace("\r","").replace("\n","")}function getHighlightedTextRelativeToRoot({rootElement:e,startOffset:t,length:n,excludeTags:i=l,excludeWhiteSpaceAndReturns:r=!1}){const s=a(e).textContentExcludingTags(arrayToLower(i)),o=(r?normaliseText(s):s).substring(t,Number.parseInt(t)+Number.parseInt(n)),h=document.createTextNode(o),g=document.createElement("div");return g.appendChild(h),g.innerText}function findHigherPriorityHighlights(e,t,n,i){const r=a(t).parentsUpTo(e),s=n[i],o=[];return r.forEach((e=>{const t=function getHighlighterNamespace(e,t){return t.find((t=>!!e.getAttribute(t)))}(e,Object.keys(n));t&&n[t]>s&&o.push({element:e,namespacePriority:n[t]})})),o.sort(((e,t)=>t.namespacePriority-e.namespacePriority)),o.map((({element:e})=>e))}function focusHighlightNodes(e,t,n,r,s,o,l,h=i){t.forEach((t=>{const s=t.node,o=findHigherPriorityHighlights(r,s,l,h),g=function isClosestHighlightParent(e,t,n=i,r=null){let s=!0,o=e.parentNode,l=0;for(;o&&o!==t&&s;)isElementHighlight(o,n)?(l+=1,r&&!o.classList.contains(r)?s=!1:o=o.parentNode):o=o.parentNode;return 0!==l&&s}(s,r,h,e);if(0===o.length&&!g){a(s).parentsUpTo(r).forEach((t=>{isElementHighlight(t,h)&&t.classList.contains(e)&&(t.childNodes.forEach((e=>{if(!e.contains(s)){const t=n.cloneNode(!0);a(e).wrap(t)}})),a(t).unwrap())}));let i=s;t.offset>0&&(i=s.splitText(t.offset)),t.length<i.textContent.length&&i.splitText(t.length),a(i).wrap(n.cloneNode(!0))}})),o&&a(r).normalizeElements(s,h)}const h={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8},dom_dom=function(e){return{addClass:function(t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass:function(t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t+"(\\b|$)","gi")," ")},prepend:function(t){let n=Array.prototype.slice.call(t),i=n.length;for(;i--;)e.insertBefore(n[i],e.firstChild)},append:function(t){let n=Array.prototype.slice.call(t);for(let t=0,i=n.length;t<i;++t)e.appendChild(n[t])},insertAfter:function(t){return t.parentNode.insertBefore(e,t.nextSibling)},insertBefore:function(t){return t.parentNode.insertBefore(e,t)},remove:function(){e.parentNode.removeChild(e),e=null},contains:function(t){return e!==t&&e.contains(t)},wrap:function(t){return e.parentNode&&e.parentNode.insertBefore(t,e),t.appendChild(e),t},unwrap:function(){let t,n=Array.prototype.slice.call(e.childNodes);return n.forEach((function(e){t=e.parentNode,dom_dom(e).insertBefore(e.parentNode)})),dom_dom(t).remove(),n},parents:function(){let t,n=[];for(;t=e.parentNode;)n.push(t),e=t;return n},parentsUpTo:function(t){let n,i=[];for(;(n=e.parentNode)&&n!==t;)i.push(n),e=n;return i},parentsWithoutDocument:function(){return this.parents().filter((e=>e!==document))},nextClosestSibling:function(t){let n,i=e;do{n=i.nextSibling,i=i.parentNode}while(!n&&i.parentNode&&t.contains(i));return t.contains(i)||(n=null),n},normalizeTextNodes:function(){if(e){if(e.nodeType===h.TEXT_NODE)for(;e.nextSibling&&e.nextSibling.nodeType===h.TEXT_NODE;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else dom_dom(e.firstChild).normalizeTextNodes();dom_dom(e.nextSibling).normalizeTextNodes()}},normalizeElements:function(t,n=i){if(e){if(e.nodeType!==h.TEXT_NODE)if(isElementHighlight(e,n)){let i=e.className;for(;i&&e.nextSibling&&e.nextSibling.nodeType!==h.TEXT_NODE&&e.nextSibling.className===i&&i!==t;)e.innerHTML+=e.nextSibling.innerHTML,e.parentNode.removeChild(e.nextSibling);dom_dom(e.firstChild).normalizeElements(t,n)}else{let i=e.id;for(;i&&e.nextSibling&&e.nextSibling.nodeType!==h.TEXT_NODE&&e.nextSibling.id===i;)e.innerHTML+=e.nextSibling.innerHTML,e.parentNode.removeChild(e.nextSibling);dom_dom(e.firstChild).normalizeElements(t,n)}else dom_dom(e).normalizeTextNodes();dom_dom(e.nextSibling).normalizeElements(t,n)}},color:function(){return e.style.backgroundColor},fromHTML:function(e){let t=document.createElement("div");return t.innerHTML=e,t.childNodes},getRange:function(){let t,n=dom_dom(e).getSelection();return n.rangeCount>0&&(t=n.getRangeAt(0)),t},removeAllRanges:function(){dom_dom(e).getSelection().removeAllRanges()},getSelection:function(){return dom_dom(e).getWindow().getSelection()},getWindow:function(){return dom_dom(e).getDocument().defaultView},getDocument:function(){return e.ownerDocument||e},isAfter:function(t,n){let i=e.nextSibling,r=!1;for(;i&&!r;)i===t?r=!0:i=i.nextSibling?i.nextSibling:e.parentNode.nextSibling;return r},textContentExcludingTags:function(t){if(e&&e.nodeType===h.COMMENT_NODE)return"";if(e&&e.nodeType!==h.TEXT_NODE){const n=e.cloneNode(!0);[n.querySelectorAll("*")].filter((e=>e.nodeType===h.COMMENT_NODE)).forEach((e=>{e.remove()}));return t.reduce(((e,t)=>[...e,...n.querySelectorAll(t)]),[]).forEach((e=>{e.remove()})),n.textContent}return e.textContent},getChildIndex:function(t){let n=e.firstChild,i=0;for(;n&&t!==n;)n!==t&&(n=n.nextSibling,i++);return n?i:-1},turnOffEventHandlers:function(t){if(e){if(e.childNodes&&e.childNodes.length>0)dom_dom(e.firstChild).turnOffEventHandlers(t);else if(e.nodeType!==h.TEXT_NODE&&e.attributes){let n=dom_dom(e).turnOffEventHandlersForElement();n&&t.push(n)}dom_dom(e.nextSibling).turnOffEventHandlers(t)}},turnOnEventHandlers:function(t){if(!e||!t||0===t.length)return;let n=Array.prototype.slice.call(e.querySelectorAll("[temp-id]"));t.forEach((e=>{let t=e.tempId,i=e.listOfAttributes,r=n.filter((e=>e.getAttribute("temp-id")===t))[0];r&&(dom_dom(r).addAttributes(i),r.removeAttribute("temp-id"))}))},turnOffEventHandlersForElement:function(){if(!e)return null;if(e.nodeType!==h.TEXT_NODE&&e.nodeType!==h.COMMENT_NODE&&e.childNodes&&0===e.childNodes.length){var t=[].slice.call(e.attributes),n=[];let s;for(s=0;s<t.length;s++){var i=t[s].name;if(0===i.indexOf("on")){var r={};r.attribute=t[s].name,r.value=t[s].value,n.push(r),e.attributes.removeNamedItem(i)}}if(n.length>0){const t=`hlt-${Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}`;return e.setAttribute("temp-id",t),{tempId:t,listOfAttributes:n}}}},addAttributes:function(t){if(!e)return;let n;for(n=0;n<t.length;n++){let i=t[n];e.setAttribute(i.attribute,i.value)}}}},a=dom_dom;const g=class PrimitivoHighlighter{constructor(e,t){this.el=e,this.options=t}highlightRange(e,t){if(!e||e.collapsed)return[];let n,r,s,o=function refineRangeBoundaries(e){let t=e.startContainer,n=e.endContainer,i=e.commonAncestorContainer,r=!0;if(0===e.endOffset){for(;!n.previousSibling&&n.parentNode!==i;)n=n.parentNode;n=n.previousSibling}else n.nodeType===h.TEXT_NODE?e.endOffset<n.nodeValue.length&&n.splitText(e.endOffset):e.endOffset>0&&(n=n.childNodes.item(e.endOffset-1));return t.nodeType===h.TEXT_NODE?e.startOffset===t.nodeValue.length?r=!1:e.startOffset>0&&(t=t.splitText(e.startOffset),n===t.previousSibling&&(n=t)):t=e.startOffset<t.childNodes.length?t.childNodes.item(e.startOffset):t.nextSibling,{startContainer:t,endContainer:n,goDeeper:r}}(e),g=o.startContainer,d=o.endContainer,c=o.goDeeper,u=!1,f=g,p=[];do{c&&f.nodeType===h.TEXT_NODE&&(-1===l.indexOf(f.parentNode.tagName)&&""!==f.nodeValue.trim()&&(r=t.cloneNode(!0),r.setAttribute(i,!0),s=f.parentNode,(a(this.el).contains(s)||s===this.el)&&(n=a(f).wrap(r),p.push(n))),c=!1),f!==d||d.hasChildNodes()&&c||(u=!0),f.tagName&&l.indexOf(f.tagName)>-1&&(d.parentNode===f&&(u=!0),c=!1),c&&f.hasChildNodes()?f=f.firstChild:f.nextSibling?(f=f.nextSibling,c=!0):(f=f.parentNode,c=!1)}while(!u);return p}normalizeHighlights(e){var t;return this.flattenNestedHighlights(e),this.mergeSiblingHighlights(e),(t=function unique(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))}(t=e.filter((function(e){return e.parentElement?e:null})))).sort((function(e,t){return e.offsetTop-t.offsetTop||e.offsetLeft-t.offsetLeft})),t}flattenNestedHighlights(e){let t,n=this;function flattenOnce(){let t=!1;return e.forEach((function(s,o){let l=s.parentElement,h=l.previousSibling,g=l.nextSibling;if(n.isHighlight(l,i))if(haveSameColor(l,s))l.replaceChild(s.firstChild,s),e[o]=l,t=!0;else{if(s.nextSibling||(g?a(s).insertBefore(g):a(s).insertAfter(l),a(s).insertBefore(g||l),t=!0),s.previousSibling||(h?a(s).insertAfter(h):a(s).insertBefore(l),a(s).insertAfter(h||l),t=!0),s.previousSibling&&3==s.previousSibling.nodeType&&s.nextSibling&&3==s.nextSibling.nodeType){let e=document.createElement("span");e.style.backgroundColor=l.style.backgroundColor,e.className=l.className;let n=l.attributes[r].nodeValue;e.setAttribute(r,n),e.setAttribute(i,!0);let o=e.cloneNode(!0);a(s.previousSibling).wrap(e),a(s.nextSibling).wrap(o),Array.prototype.slice.call(l.childNodes).forEach((function(e){a(e).insertBefore(e.parentNode)})),t=!0}l.hasChildNodes()||a(l).remove()}})),t}sortByDepth(e,!0);do{t=flattenOnce()}while(t)}mergeSiblingHighlights(e){var t=this;function shouldMerge(e,n){return n&&n.nodeType===h.ELEMENT_NODE&&haveSameColor(e,n)&&t.isHighlight(n,i)}e.forEach((function(e){var t=e.previousSibling,n=e.nextSibling;shouldMerge(e,t)&&(a(e).prepend(t.childNodes),a(t).remove()),shouldMerge(e,n)&&(a(e).append(n.childNodes),a(n).remove()),a(e).normalizeTextNodes()}))}doHighlight(e){let t,n,i,s,o=a(this.el).getRange();o&&!o.collapsed&&(!0===this.options.onBeforeHighlight(o)&&(s=+new Date,t=createWrapper(this.options),t.setAttribute(r,s),n=this.highlightRange(o,t),i=this.normalizeHighlights(n),this.options.onAfterHighlight(o,i,s)),e||a(this.el).removeAllRanges())}removeHighlights(e){var t=e||this.el,n=this.getHighlights({container:t}),i=this;function removeHighlight(e){a(e).unwrap().forEach((function(e){!function mergeSiblingTextNodes(e){var t=e.previousSibling,n=e.nextSibling;t&&t.nodeType===h.TEXT_NODE&&(e.nodeValue=t.nodeValue+e.nodeValue,a(t).remove()),n&&n.nodeType===h.TEXT_NODE&&(e.nodeValue=e.nodeValue+n.nodeValue,a(n).remove())}(e)}))}sortByDepth(n,!0),n.forEach((function(e){!0===i.options.onRemoveHighlight(e)&&removeHighlight(e)}))}getHighlights(e){return retrieveHighlights({container:this.el,dataAttr:i,timestampAttr:r,...e})}isHighlight(e,t){return isElementHighlight(e,t)}serializeHighlights(){let e=this.getHighlights(),t=this.el,n=[];return sortByDepth(e,!1),e.forEach((function(e){let i=0,r=e.textContent.length,s=function getElementPath(e,t){let n,i=[];do{n=Array.prototype.slice.call(e.parentNode.childNodes),i.unshift(n.indexOf(e)),e=e.parentNode}while(e!==t||!e);return i}(e,t),o=e.cloneNode(!0);o.innerHTML="",o=o.outerHTML,e.previousSibling&&e.previousSibling.nodeType===h.TEXT_NODE&&(i=e.previousSibling.length),n.push([o,e.textContent,s.join(":"),i,r])})),JSON.stringify(n)}deserializeHighlights(e){let t,n=[],i=this;if(!e)return n;try{t=JSON.parse(e)}catch(e){throw"Can't parse JSON: "+e}return t.forEach((function(e){try{!function deserializationFn(e){let t,r,s,o={wrapper:e[0],text:e[1],path:e[2].split(":"),offset:e[3],length:e[4]},l=o.path.pop(),g=i.el;for(;s=o.path.shift();)g=g.childNodes[s];g.childNodes[l-1]&&g.childNodes[l-1].nodeType===h.TEXT_NODE&&(l-=1),g=g.childNodes[l],t=g.splitText(o.offset),t.splitText(o.length),t.nextSibling&&!t.nextSibling.nodeValue&&a(t.nextSibling).remove(),t.previousSibling&&!t.previousSibling.nodeValue&&a(t.previousSibling).remove(),r=a(t).wrap(a().fromHTML(o.wrapper)[0]),n.push(r)}(e)}catch(e){console&&console.warn&&console.warn("Can't deserialize highlight descriptor. Cause: "+e)}})),n}};const d=class IndependenciaHighlighter{constructor(e,t){this.el=e,this.options=t,this.removedHighlights={}}doHighlight(e){let t,n,h=a(this.el).getRange();if(!h||h.collapsed)return;let g=[];if(a(this.el).turnOffEventHandlers(g),!0===this.options.onBeforeHighlight(h)){n=+new Date,t=createWrapper(this.options),t.setAttribute(r,n);const e=function createDescriptors({rootElement:e,range:t,wrapper:n,excludeNodeNames:r=l,dataAttr:h=i,excludeWhiteSpaceAndReturns:a=!1}){const g=n.cloneNode(!0),d=a?normaliseOffset(t.startOffset,t.startContainer.textContent):t.startOffset,c=getElementOffset(t.startContainer,e,r,a,d,!0),u=a?normaliseOffset(t.endOffset,t.endContainer.textContent):t.endOffset,f=(t.startContainer===t.endContainer?c+(u-d):getElementOffset(t.endContainer,e,r,a,u,!1))-c;return g.setAttribute(h,!0),g.setAttribute(s,c),g.setAttribute(o,f),g.innerHTML="",[[g.outerHTML,getHighlightedTextForRange(t,r),c,f]]}({rootElement:this.el,range:h,wrapper:t,excludeNodeNames:this.options.excludeNodes,dataAttr:this.options.namespaceDataAttribute,excludeWhiteSpaceAndReturns:this.options.excludeWhiteSpaceAndReturns}),{descriptors:a,meta:g}=this.options.preprocessDescriptors(h,e,n);g[this.options.cancelProperty]||(this.deserializeHighlights(JSON.stringify(a)),this.options.onAfterHighlight(h,a,n,g))}e||a(this.el).removeAllRanges(),a(this.el).turnOnEventHandlers(g)}normalizeHighlights(){a(this.el).normalizeElements(this.options.highlightedClass,this.options.namespaceDataAttribute)}removeHighlights(e,t){const n=e||this.el;let i=this.getHighlights({container:n,dataAttr:this.options.namespaceDataAttribute}),r=this;i.forEach((function(e){if(!t||t&&e.classList.contains(t)){let t=e.classList.length>1?e.classList[1]:null;t&&r.removedHighlights[t]?a(e).unwrap():!0===r.options.onRemoveHighlight(e)&&(a(e).unwrap(),t&&(r.removedHighlights[t]=!0))}})),this.options.normalizeElements&&this.normalizeHighlights(i)}getHighlights(e){return retrieveHighlights({container:this.el,dataAttr:e.dataAttr,timestampAttr:r,...e})}isHighlight(e,t){return isElementHighlight(e,t)}serializeHighlights(e){const t=this.getHighlights({dataAttr:this.options.namespaceDataAttribute});if(sortByDepth(t,!1),0===t.length)return[];let n=[];a(this.el).turnOffEventHandlers(n);const i=t.find((t=>t.classList.contains(e)));if(!i)return[];const r=i.getAttribute(o),l=i.getAttribute(s),h=i.cloneNode(!0);h.innerHTML="";const g=[h.outerHTML,getHighlightedTextRelativeToRoot({rootElement:this.el,startOffset:l,length:r,excludeTags:this.options.excludeNodes,excludeWhiteSpaceAndReturns:this.options.excludeWhiteSpaceAndReturns}),l,r];return a(this.el).turnOnEventHandlers(n),JSON.stringify([g])}deserializeHighlights(e){let t,n=[],i=this;if(!e)return n;try{t=JSON.parse(e)}catch(e){throw"Can't parse JSON: "+e}let r=[];return a(this.el).turnOffEventHandlers(r),t.forEach((function(e){try{!function validateIndependenciaDescriptors(e){return!(!e||4!==e.length)}(e)?console.warn("Can't deserialize highlight descriptors. Cause: descriptors are not valid."):function deserialise(e){let t,r,s={wrapper:e[0],text:e[1],offset:Number.parseInt(e[2]),length:Number.parseInt(e[3])};const o=i.el,{nodesAndOffsets:l}=findNodesAndOffsets(s,o,i.options.excludeNodes,i.options.excludeWhiteSpaceAndReturns);l.forEach((({node:e,offset:l,length:h})=>{const{priorities:g,namespaceDataAttribute:d}=i.options,c=findHigherPriorityHighlights(o,e,g,d);e.textContent.trim().replace(/(\r\n|\n|\r)/gm,"").length>0&&(t=e.splitText(l),t.splitText(h),t.nextSibling&&!t.nextSibling.nodeValue&&a(t.nextSibling).remove(),t.previousSibling&&!t.previousSibling.nodeValue&&a(t.previousSibling).remove(),c.forEach((e=>{const n=e.cloneNode(!1);t=a(t).wrap(n)})),r=a(t).wrap(a().fromHTML(s.wrapper)[0]),n.push(r))}))}(e)}catch(e){console&&console.warn&&console.warn("Can't deserialize highlight descriptor. Cause: "+e)}})),this.options.normalizeElements&&this.normalizeHighlights(),a(this.el).turnOnEventHandlers(r),n}focusUsingId(e,t){const n=this.el.querySelectorAll(`.${e}[${this.options.namespaceDataAttribute}="true"]`);let i=[];if(a(this.el).turnOffEventHandlers(i),n.length>0){const t=n[0],{nodesAndOffsets:i}=findNodesAndOffsets({offset:Number.parseInt(t.getAttribute(s)),length:Number.parseInt(t.getAttribute(o))},this.el,this.options.excludeNodes,this.options.excludeWhiteSpaceAndReturns),r=t.cloneNode(!0);r.innerHTML="",focusHighlightNodes(e,i,r,this.el,this.options.highlightedClass,this.options.normalizeElements,this.options.priorities,this.options.namespaceDataAttribute)}else t&&this.deserializeHighlights(t);a(this.el).turnOnEventHandlers(i)}deselectUsingId(e,t){const n=this.el.querySelector(`.${e}`);if(n){const e=Number.parseInt(n.getAttribute(s)),i=Number.parseInt(n.getAttribute(o)),r=t.map((e=>({id:e.id,descriptor:JSON.parse(e.serialisedDescriptor)}))).filter((t=>{const n=t.descriptor[0],r=Number.parseInt(n[2]),s=Number.parseInt(n[3]);return r>=e&&r+s<=e+i}));r.sort(((e,t)=>Number.parseInt(e.descriptor[0][3])>Number.parseInt(t.descriptor[0][3])?-1:1)),r.forEach((e=>{this.focusUsingId(e.id,JSON.stringify(e.descriptor))}))}}},c={primitivo:g,"v1-2014":g,independencia:d,"v2-2019":d},u={"v1-2014":"Primitivo (v1-2014)",primitivo:"Primitivo (v1-2014)","v2-2019":"Independencia (v2-2019)",independencia:"Independencia (v2-2019)"};const f=class TextHighlighter{static createWrapper(e){return createWrapper(e)}constructor(e,t={},n=!0){if(!e)throw new Error("Missing anchor element");if(this.el=e,this.options={color:"#ffff7b",highlightedClass:"highlighted",contextClass:"highlighter-context",version:"independencia",useDefaultEvents:!0,excludeNodes:l,excludeWhiteSpaceAndReturns:!1,namespaceDataAttribute:i,priorities:{},normalizeElements:!1,keepRange:!1,cancelProperty:"cancel",onRemoveHighlight:function(){return!0},onBeforeHighlight:function(){return!0},preprocessDescriptors:function(e,t){return{descriptors:t,meta:{}}},onAfterHighlight:function(){},...t},this.highlightHandler=this.highlightHandler.bind(this),!c[this.options.version])throw new Error("Please provide a valid version of the text highlighting functionality");this.highlighter=new c[this.options.version](this.el,this.options),a(this.el).addClass(this.options.contextClass),n&&this.registerDefaultEvents()}destroy(){this.options.useDefaultEvents&&function unbindEvents(e,t){e.removeEventListener("mouseup",t.highlightHandler),e.removeEventListener("touchend",t.highlightHandler)}(this.el,this),a(this.el).removeClass(this.options.contextClass)}registerDefaultEvents(){this.options.useDefaultEvents&&function bindEvents(e,t){e.addEventListener("mouseup",t.highlightHandler),e.addEventListener("touchend",t.highlightHandler)}(this.el,this)}highlightHandler(){this.doHighlight()}doHighlight(){this.highlighter.doHighlight(this.options.keepRange)}highlightRange(e,t){return this.highlighter.highlightRange(e,t)}normalizeHighlights(e){return this.highlighter.normalizeHighlights(e)}setColor(e){this.options.color=e}getColor(){return this.options.color}removeHighlights(e,t){this.highlighter.removeHighlights(e,t)}getHighlights(e){return this.highlighter.getHighlights(e)}isHighlight(e,t=i){return this.highlighter.isHighlight(e,t)}serializeHighlights(e){return this.highlighter.serializeHighlights(e)}deserializeHighlights(e){return this.highlighter.deserializeHighlights(e)}find(e,t){let n=a(this.el).getWindow(),i=n.scrollX,r=n.scrollY,s=void 0===t||t;if(a(this.el).removeAllRanges(),n.find)for(;n.find(e,s);)this.doHighlight(!0);else if(n.document.body.createTextRange){let t=n.document.body.createTextRange();for(t.moveToElementText(this.el);t.findText(e,1,s?4:0)&&(a(this.el).contains(t.parentElement())||t.parentElement()===this.el);)t.select(),this.doHighlight(!0),t.collapse(!1)}a(this.el).removeAllRanges(),n.scrollTo(i,r)}focusUsingId(e,t){this.highlighter.focusUsingId?this.highlighter.focusUsingId(e,t):console.warn(`The ${u[this.options.version]} version of the text highlighter does not support focusing highlights.`)}deselectUsingId(e,t){this.highlighter.deselectUsingId?this.highlighter.deselectUsingId(e,t):console.warn(`The ${u[this.options.version]} version of the text highlighter does not support deselecting highlights.`)}}}}]);