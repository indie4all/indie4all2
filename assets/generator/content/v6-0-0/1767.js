(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[1767,5738],{37182:(t,e,n)=>{var i=n(93633);function __default(t){return t&&(t.__esModule?t.default:t)}t.exports=(i.default||i).template({1:function(t,e,n,i,o){return"47%"},3:function(t,e,n,i,o){return"25%"},5:function(t,e,n,i,o){return'<i class="fa fa-spinner fa-spin fa-3x" aria-hidden="true"></i>'},7:function(t,e,n,i,o){return'<i class="fa fa-exclamation-triangle fa-3x" aria-hidden="true"></i>'},compiler:[8,">= 4.3.0"],main:function(t,e,i,o,s){var r,a,l=null!=e?e:t.nullContext||{},c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="cargando" \r\n  style="height:100%; width:100%; position: absolute; z-index: 10000; background-color: rgba(0, 0, 0, 0.5); top: 0;">\r\n  <div class="text-center" style="position: absolute; top: 30%; \r\n    left:'+(null!=(r=__default(n(6088)).call(l,null!=e?c(e,"status"):e,"loading",{name:"ifeq",hash:{},fn:t.program(1,s,0),inverse:t.noop,data:s,loc:{start:{line:4,column:9},end:{line:4,column:47}}}))?r:"")+(null!=(r=__default(n(20884)).call(l,null!=e?c(e,"status"):e,"loading",{name:"ifneq",hash:{},fn:t.program(3,s,0),inverse:t.noop,data:s,loc:{start:{line:4,column:47},end:{line:4,column:87}}}))?r:"")+';">\r\n    '+(null!=(r=__default(n(6088)).call(l,null!=e?c(e,"status"):e,"loading",{name:"ifeq",hash:{},fn:t.program(5,s,0),inverse:t.noop,data:s,loc:{start:{line:5,column:4},end:{line:5,column:101}}}))?r:"")+"\r\n    "+(null!=(r=__default(n(6088)).call(l,null!=e?c(e,"status"):e,"error",{name:"ifeq",hash:{},fn:t.program(7,s,0),inverse:t.noop,data:s,loc:{start:{line:6,column:4},end:{line:6,column:104}}}))?r:"")+'\r\n    <p class="white" style="color:white;"><strong>'+t.escapeExpression("function"==typeof(a=null!=(a=c(i,"message")||(null!=e?c(e,"message"):e))?a:t.hooks.helperMissing)?a.call(l,{name:"message",hash:{},data:s,loc:{start:{line:7,column:50},end:{line:7,column:61}}}):a)+"</strong></p>\r\n  </div>\r\n</div>"},useData:!0})},5738:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>m});var i=n(65360),o=n(7979),s=n(93113),r=n(25715),a=n(96107),l=n(75015),c=n(35999),__decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let d=class VideoAnalyticsService{constructor(t){this.PAUSE_THRESHOLD=2,this.analyticsSubject=new a.B,this.analyticsEvent$=this.analyticsSubject.asObservable(),this.ranges={},t.getInteractions(l.SB).subscribe((t=>{if(this.ranges[t.id]||(this.ranges[t.id]=[]),0==this.ranges[t.id].length)return void this.ranges[t.id].push({start:t.time,end:t.time});const e=this.ranges[t.id][this.ranges[t.id].length-1];Math.abs(e.end-t.time)>.5?this.ranges[t.id].push({start:t.time,end:t.time}):e.end=t.time})),t.getInteractions(l.Ym).subscribe((t=>{if(!this.ranges[t.id]||!this.ranges[t.id].length)return;const e=this.ranges[t.id][this.ranges[t.id].length-1],n=t.time;Math.abs(e.end-n)>this.PAUSE_THRESHOLD||(this.analyticsSubject.next({id:t.id,type:t.type,title:t.description,duration:t.duration,ranges:this.ranges[t.id]}),this.ranges[t.id]=[])})),t.getInteractions(l.Hc).subscribe((t=>{this.ranges[t.id]&&this.ranges[t.id].length&&(this.analyticsSubject.next({id:t.id,type:t.type,title:t.description,duration:t.duration,ranges:this.ranges[t.id]}),this.ranges[t.id]=[])}))}get events(){return this.analyticsEvent$}};d=__decorate([(0,i.k)({global:!0}),__metadata("design:paramtypes",[c.A])],d);const u=d;var h=n(37182),f=n.n(h),progress_interoperability_service_decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},progress_interoperability_service_metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function fulfilled(t){try{step(i.next(t))}catch(t){s(t)}}function rejected(t){try{step(i.throw(t))}catch(t){s(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())}))};let p=class ProgressInteroperabilityService extends r.default{constructor(t,e,n){super(t),this.objService=t,this.bootstrap=e,this.videoAnalytics=n}onError(t){if(console.error("Error:",t),401===t.status)return void this.modal.hide();const e=400===t.status?"ADVERTENCIA: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!":"ERROR: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";this.modalElem.innerHTML=f()({message:e,status:"error"}),this.modal.show()}resume(){return __awaiter(this,void 0,void 0,(function*(){this.keepAliveIntervalId||(this.keepAliveIntervalId=setInterval(this.keepAlive,6e5));const t=yield fetch("../../contentunit/php/funcioneslaltiv4.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:0})});t.ok?this.modal.hide():this.onError(t)}))}pause(){return __awaiter(this,void 0,void 0,(function*(){this.keepAliveIntervalId&&clearInterval(this.keepAliveIntervalId),this.keepAliveIntervalId=null,yield fetch("../../contentunit/php/funcioneslaltiv4.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:1}),keepalive:!0})}))}keepAlive(){return __awaiter(this,void 0,void 0,(function*(){const t=yield fetch("../../contentunit/php/funcioneslaltiv4.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:5})});t.ok?this.modal.hide():this.onError(t)}))}startGame(t,e,n){return __awaiter(this,void 0,void 0,(function*(){const i=yield fetch("../../contentunit/php/funcionesGamev3.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idunidad:t,idwidget:e,origin:n})});if(!i.ok)return void this.onError(i);const o="https://game.upct.es/"+(yield i.json()).codgame+"/teacher/";location.replace(o)}))}init(){const t=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){t.init.call(this),this.modalModule=yield this.bootstrap.loadModalModule(),this.modalElem=document.getElementById("sharedModal"),this.modal=this.modalModule.getOrCreateInstance(this.modalElem),this.modalElem.addEventListener("hidden.bs.modal",(()=>{this.modalElem.innerHTML=""})),this.videoAnalytics.events.subscribe((t=>__awaiter(this,void 0,void 0,(function*(){const e=yield fetch("../../contentunit/php/funcioneslaltiv4.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:2,element:`objetivo${t.id}`,namevideo:t.title,notes:JSON.stringify({video:[{Type:"Range",Ranges:t.ranges,Duration:t.duration}]})})});e.ok||this.onError(e)})))),this.objService.events.subscribe((t=>__awaiter(this,void 0,void 0,(function*(){const e=yield fetch("../../contentunit/php/funcionesobjetivoltiv5.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({objetivo:{id:`objetivo${t.id}`,nombre:t.description}})});if(!e.ok)return void this.onError(e);const n=yield fetch("../../contentunit/php/funcioneslaltiv4.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:3,element:`objetivo${t.id}`,notes:t.type,namevideo:t.description})});n.ok||this.onError(n)})))),document.addEventListener("visibilitychange",(()=>__awaiter(this,void 0,void 0,(function*(){"hidden"===document.visibilityState?yield this.pause():yield this.resume()})))),this.resume()}))}};p=progress_interoperability_service_decorate([(0,i.k)({global:!0}),progress_interoperability_service_metadata("design:paramtypes",[s.A,o.A,u])],p);const m=p},21767:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>m});var i=n(65360),o=n(7979),s=n(24971),r=n(40561),a=n(44295),l=n(37607),c=n(89953),d=n(5738),u=n(75521),h=n(70583),f=n(61709),__decorate=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function fulfilled(t){try{step(i.next(t))}catch(t){s(t)}}function rejected(t){try{step(i.throw(t))}catch(t){s(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())}))};let p=class InteroperabilityUnit extends u.default{constructor(t,e,n,i,o,s,r,a,l){super(t,e,n,i,o,s,r,l),this.factory=t,this.menu=e,this.voiceControl=n,this.bootstrap=i,this.utils=o,this.i18n=s,this.code=r,this.progress=a,this.mathjax=l}init(){const t=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){yield t.init.call(this),document.querySelectorAll(".btn-start-game").forEach((t=>{t.addEventListener("click",(t=>{t.target instanceof HTMLElement&&this.progress.startGame(this.id,t.target.dataset.widget,t.target.dataset.origin)}))}))}))}};p=__decorate([(0,i.k)(),__metadata("design:paramtypes",[r.default,c.A,f.A,o.A,h.A,a.A,s.A,d.default,l.A])],p);const m=p},6088:(t,e,n)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(t,e,n){if(t==e)return n.fn(this)}n.r(e),n.d(e,{default:()=>__WEBPACK_DEFAULT_EXPORT__})},20884:(t,e,n)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(t,e,n){if(t!=e)return n.fn(this)}n.r(e),n.d(e,{default:()=>__WEBPACK_DEFAULT_EXPORT__})}}]);