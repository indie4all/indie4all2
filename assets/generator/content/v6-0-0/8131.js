"use strict";(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[8131],{8131:(t,e,i)=>{i.r(e),i.d(e,{default:()=>c});var s=i(65360),n=i(93113),o=i(25715),__decorate=function(t,e,i,s){var n,o=arguments.length,r=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(o<3?n(r):o>3?n(e,i,r):n(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function fulfilled(t){try{step(s.next(t))}catch(t){o(t)}}function rejected(t){try{step(s.throw(t))}catch(t){o(t)}}function step(t){t.done?n(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((s=s.apply(t,e||[])).next())}))};let r=class ProgressScormService extends o.default{convertMilliSecondsIntoSCORM2004Time(t){let e="";const i=6e3,s=36e4,n=864e4,o=26298e4,r=315576e4;let c=Math.floor(t/10);const a=Math.floor(c/r);c-=a*r;const l=Math.floor(c/o);c-=l*o;const u=Math.floor(c/n);c-=u*n;const h=Math.floor(c/s);c-=h*s;const m=Math.floor(c/i);c-=m*i;const d=Math.floor(c/100);return c-=100*d,a>0&&(e+=a+"Y"),l>0&&(e+=l+"M"),u>0&&(e+=u+"D"),c+d+m+h>0&&(e+="T",h>0&&(e+=h+"H"),m>0&&(e+=m+"M"),c+d>0&&(e+=d,c>0&&(e+="."+c),e+="S")),""==e&&(e="0S"),e="P"+e,e}scanForAPI(t){let e=0;for(;null==t.API_1484_11&&null!=t.parent&&t.parent!=t;){if(e++,e>500)return null;t=t.parent}return t.API_1484_11}getScormValue(t){if(this.terminateCalled)return;const e=this.api.GetValue(t);if(""==e){const t=this.api.GetLastError();if("0"!=t){const e=this.api.GetErrorString(t),i=this.api.GetDiagnostic(t);return alert("Error - Could not retrieve a value from the LMS.\n\n"+("Number: "+t+"\nDescription: "+e+"\nDiagnostic: "+i)),""}}return e}setScormValue(t,e){if(this.terminateCalled)return;if("false"!=this.api.SetValue(t,e));else{const t=this.api.GetLastError(),e=this.api.GetErrorString(t),i=this.api.GetDiagnostic(t);alert("Error - Could not store a value in the LMS.\n\nYour results may not be recorded.\n\n"+("Number: "+t+"\nDescription: "+e+"\nDiagnostic: "+i))}}setLessonStatus(t){this.setScormValue("cmi.score.raw",t.toString()),this.setScormValue("cmi.score.min","0"),this.setScormValue("cmi.score.max","100"),this.setScormValue("cmi.score.scaled",(t/100).toString()),100==t?(this.setScormValue("cmi.completion_status","completed"),this.setScormValue("cmi.success_status","passed")):this.setScormValue("cmi.success_status","failed")}terminate(){if(this.terminateCalled)return;const t=this.api.Terminate("");if(this.terminateCalled=!0,"false"!=t);else{const t=this.api.GetLastError(),e=this.api.GetErrorString(t),i=this.api.GetDiagnostic(t);alert("Error - Could not terminate communication with the LMS.\n\nYour results may not be recorded.\n\n"+("Number: "+t+"\nDescription: "+e+"\nDiagnostic: "+i))}}unload(t){if(this.processedUnload)return;this.processedUnload=!0;const e=(new Date).getTime()-this.startTimeStamp.getTime(),i=this.convertMilliSecondsIntoSCORM2004Time(e);this.setScormValue("cmi.session_time",i),t||this.setScormValue("cmi.exit","suspend"),this.terminate()}initObjective(t,e){const i="cmi.objectives."+t;return 0==this.numberObjectives?(this.setScormValue(i+".id",e),this.setScormValue(i+".completion_status","incomplete"),this.setScormValue(i+".success_status","failed"),this.setScormValue(i+".score.raw","0"),this.setScormValue(i+".score.min","0"),this.setScormValue(i+".score.max","100"),this.setScormValue(i+".score.scaled","0"),"incomplete"):this.getScormValue(i+".completion_status")}setObjectiveFinished(t){this.setScormValue(`cmi.objectives.${t}.completion_status`,"completed"),this.setScormValue(`cmi.objectives.${t}.success_status`,"passed"),this.setScormValue(`cmi.objectives.${t}.score.raw`,"100"),this.setScormValue(`cmi.objectives.${t}.score.scaled`,"1")}constructor(t){super(t),this.objService=t,this.startTimeStamp=new Date,this.terminateCalled=!1,this.processedUnload=!1,this.numberObjectives=0,this.startTimeStamp=new Date}init(){const t=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){if(yield t.init.call(this),null!=window.parent&&window.parent!=window&&(this.api=this.scanForAPI(window.parent)),null==this.api&&null!=window.opener&&(this.api=this.scanForAPI(window.opener)),null==this.api){yield i.e(1045).then(i.t.bind(i,31045,23));const t=new Scorm2004API({logLevel:2});window.API_1484_11=t,this.api=t}if("false"==this.api.Initialize("")){const t=this.api.GetLastError(),e=this.api.GetErrorString(t),i=this.api.GetDiagnostic(t);return void alert("Error - Could not initialize communication with the LMS.\n\nYour results may not be recorded.\n\n"+("Number: "+t+"\nDescription: "+e+"\nDiagnostic: "+i))}"unknown"==this.getScormValue("cmi.completion_status")&&this.setScormValue("cmi.completion_status","incomplete"),window.addEventListener("beforeunload",(()=>this.unload(!1))),window.addEventListener("unload",(()=>this.unload(!0))),this.numberObjectives=parseInt(this.getScormValue("cmi.objectives._count")),this.objectives.flat().forEach(((t,e)=>{"completed"==this.initObjective(e.toString(),t.id)?this.markObjectiveAsCompleted(t.id):t.percentage=0})),this.redraw(),this.objService.events.subscribe((t=>{this.markObjectiveAsCompleted("objetivo"+t.id),this.redraw();const e=this.objectives.flat(),i=e.findIndex((e=>e.id==="objetivo"+t.id));if(-1===i)return;this.setObjectiveFinished(i.toString());const s=e.length,n=e.filter((t=>100===t.percentage)).length,o=0===s?100:100*n/s;this.setLessonStatus(o)}))}))}};r=__decorate([(0,s.k)({global:!0}),__metadata("design:paramtypes",[n.A])],r);const c=r}}]);