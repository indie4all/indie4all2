(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[8637],{20427:(e,t,o)=>{var n=o(93633);function __default(e){return e&&(e.__esModule?e.default:e)}e.exports=(n.default||n).template({1:function(e,t,o,n,i){return"0"},3:function(e,t,o,n,i){return"-1"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,r){var l,s,c=null!=t?t:e.nullContext||{},a=e.hooks.helperMissing,u="function",d=e.escapeExpression,h=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<input id="piece-'+d(typeof(s=null!=(s=h(n,"id")||(null!=t?h(t,"id"):t))?s:a)===u?s.call(c,{name:"id",hash:{},data:r,loc:{start:{line:1,column:17},end:{line:1,column:23}}}):s)+"-"+d(typeof(s=null!=(s=h(n,"pos")||(null!=t?h(t,"pos"):t))?s:a)===u?s.call(c,{name:"pos",hash:{},data:r,loc:{start:{line:1,column:24},end:{line:1,column:31}}}):s)+'" alt="'+d(typeof(s=null!=(s=h(n,"alt")||(null!=t?h(t,"alt"):t))?s:a)===u?s.call(c,{name:"alt",hash:{},data:r,loc:{start:{line:1,column:38},end:{line:1,column:45}}}):s)+'"\r\n  data-pos="'+d(typeof(s=null!=(s=h(n,"pos")||(null!=t?h(t,"pos"):t))?s:a)===u?s.call(c,{name:"pos",hash:{},data:r,loc:{start:{line:2,column:12},end:{line:2,column:19}}}):s)+'" data-bs-toggle="dropdown"\r\n  class="piece img-responsive" type="image"\r\n  draggable="true" aria-grabbed="false" aria-expanded="false" aria-haspopup="true"\r\n  aria-controls="dropdown-piece-'+d(typeof(s=null!=(s=h(n,"id")||(null!=t?h(t,"id"):t))?s:a)===u?s.call(c,{name:"id",hash:{},data:r,loc:{start:{line:5,column:32},end:{line:5,column:38}}}):s)+"-"+d(typeof(s=null!=(s=h(n,"pos")||(null!=t?h(t,"pos"):t))?s:a)===u?s.call(c,{name:"pos",hash:{},data:r,loc:{start:{line:5,column:39},end:{line:5,column:46}}}):s)+'" \r\n  tabindex="'+(null!=(l=__default(o(6088)).call(c,null!=t?h(t,"pos"):t,0,{name:"ifeq",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r,loc:{start:{line:6,column:12},end:{line:6,column:37}}}))?l:"")+(null!=(l=__default(o(20884)).call(c,null!=t?h(t,"pos"):t,0,{name:"ifneq",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r,loc:{start:{line:6,column:37},end:{line:6,column:65}}}))?l:"")+'" src="'+d(typeof(s=null!=(s=h(n,"url")||(null!=t?h(t,"url"):t))?s:a)===u?s.call(c,{name:"url",hash:{},data:r,loc:{start:{line:6,column:72},end:{line:6,column:79}}}):s)+'"/>'},useData:!0})},16492:(e,t,o)=>{"use strict";o.d(t,{x:()=>Widget});var n=o(7181),i=o(40561);function Widget(e){const t=n.Ay.get(i.default);return function(o){t.registerWidget(e.selector,o)}}},19412:(e,t,o)=>{"use strict";o.d(t,{A:()=>Element});var n=o(16126),i=o(3605),__awaiter=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function fulfilled(e){try{step(n.next(e))}catch(e){r(e)}}function rejected(e){try{step(n.throw(e))}catch(e){r(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};class Element{constructor(e,t,o){this.voiceControl=e,this.utils=t,this.i18n=o,this._activityNumber=0}init(){return __awaiter(this,void 0,void 0,(function*(){if(!this._widget)throw new Error("ElementHTML widget has not been set.");this.voiceControlMessageElem=this.widget.querySelector(".tta-message"),this.voiceControlButton=document.querySelector(`#speech-to-action-${this.id}`),this.voiceControlButton&&(this.voiceControlButton.addEventListener("click",(()=>{if(this.voiceControl.currentTarget!==this.id){for(;this.voiceControl.numTargets>1;)this.voiceControl.popTarget();return this._parent&&this.voiceControl.addTarget(this._parent.id),void this.voiceControl.addTarget(this.id)}this.voiceControl.popTarget(),this.voiceControlButton&&this.toggleVoiceControlButton(!1)})),this.voiceControl.voiceControlTargetChanged.subscribe((e=>{this.id===e.old&&this.toggleVoiceControlButton(!1),this.id===e.new&&this.toggleVoiceControlButton(!0)})),this.voiceControl.voiceControlActions.pipe((0,n.p)((e=>e.target===this.id))).subscribe((e=>{e instanceof i.m6?this.voiceControlStart():e instanceof i.$q?this.voiceControlFinish():e instanceof i.DZ?this.voiceControlNext():e instanceof i.vZ?this.voiceControlPrevious():e instanceof i.Fd?this.voiceControlGoto(e.position):e instanceof i.V3?this.voiceControlBack():e instanceof i.gZ?this.voiceControlSelect():e instanceof i.CG?this.voiceControlClose():e instanceof i.sT?this.voiceControlCheck():e instanceof i.XR?this.voiceControlCurrent():e instanceof i.B$?this.voiceControlDelete():e instanceof i._R?this.voiceControlMaximize():e instanceof i.EZ?this.voiceControlMinimize():e instanceof i.$V?this.voiceControlMove(e.position):e instanceof i.ow?this.voiceControlPause():e instanceof i.OR?this.voiceControlPlay():e instanceof i.pr?this.voiceControlRepeat():e instanceof i.lR?this.voiceControlReset():e instanceof i.m6?this.voiceControlStart():e instanceof i.o3?this.voiceControlStop():e instanceof i.HU?this.voiceControlWrite(e.text):e instanceof i.kw&&this.voiceControlUnknown()})))}))}get description(){return this.widget.dataset.desc||""}get id(){return this.widget.id}get type(){return this.widget.dataset.type||""}get widget(){return this._widget}set widget(e){this._widget=e}get parent(){return this._parent}set parent(e){this._parent=e}set activityNumber(e){this._activityNumber=e,this.voiceControlButton&&(this.voiceControlButton.innerHTML+=`<span class="element-number">${this.i18n.value("tta-activity-number")} ${e}</span>`)}toggleHighlight(e){this.widget.classList.toggle("speech-focused",e)}toggleVoiceControlButton(e){if(this.voiceControlButton){const t=this.voiceControlButton.querySelector("svg");t&&(t.classList.toggle("fa-head-side-cough",e),t.classList.toggle("fa-head-side-cough-slash",!e))}}showVoiceControlButton(){this.voiceControlButton&&(this.voiceControlButton.classList.add("show"),this.toggleVoiceControlButton(!1))}hideVoiceControlButton(){this.voiceControlButton&&this.voiceControlButton.classList.remove("show")}voiceControlStart(){this.toggleVoiceControlButton(!0)}voiceControlFinish(){this.voiceControl.popTarget(),this.toggleVoiceControlButton(!1)}voiceControlClose(){this.voiceControlUnknown()}voiceControlCheck(){this.voiceControlUnknown()}voiceControlCurrent(){this.voiceControlUnknown()}voiceControlDelete(){this.voiceControlUnknown()}voiceControlMaximize(){this.voiceControlUnknown()}voiceControlMinimize(){this.voiceControlUnknown()}voiceControlMove(e){this.voiceControlUnknown()}voiceControlPause(){this.voiceControlUnknown()}voiceControlPlay(){this.voiceControlUnknown()}voiceControlRepeat(){this.voiceControlUnknown()}voiceControlReset(){this.voiceControlUnknown()}voiceControlStop(){this.voiceControlUnknown()}voiceControlWrite(e){this.voiceControlUnknown()}voiceControlNext(){this.voiceControlUnknown()}voiceControlPrevious(){this.voiceControlUnknown()}voiceControlGoto(e){this.voiceControlUnknown()}voiceControlBack(){this.voiceControlUnknown()}voiceControlSelect(){this.voiceControlUnknown()}voiceControlUnknown(){this.voiceControlMessageElem.innerHTML+=this.utils.alert("alert-danger",this.i18n.value("tta-error-message"))}}},11867:(e,t,o)=>{"use strict";var n,i;o.d(t,{A:()=>l}),function(e){e[e.TERMS=0]="TERMS",e[e.OPTIONS=1]="OPTIONS"}(n||(n={})),function(e){e.ARROW_LEFT="ArrowLeft",e.ARROW_UP="ArrowUp",e.ARROW_RIGHT="ArrowRight",e.ARROW_DOWN="ArrowDown",e.END="End",e.ENTER="Enter",e.ESCAPE="Escape",e.HOME="Home",e.SPACE="Space"}(i||(i={}));var r=o(19412),__awaiter=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function fulfilled(e){try{step(n.next(e))}catch(e){r(e)}}function rejected(e){try{step(n.throw(e))}catch(e){r(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};class PuzzleElement extends r.A{constructor(e,t,o,n){super(o,e,n),this.utils=e,this.bootstrap=t,this.voiceControl=o,this.i18n=n}onKeyDownInput(e,t){if(!Object.values(i).includes(e))return!1;const o=t.closest(".dropdown").querySelector(".dropdown-menu"),n=Array.from(this.widget.querySelectorAll(".piece"));let r=n.indexOf(t);return e===i.ARROW_LEFT||e===i.ARROW_RIGHT||e===i.HOME||e===i.END?(n.forEach((e=>e.setAttribute("tabindex","-1"))),e===i.ARROW_LEFT&&(r=this.utils.mod(r-1,n.length)),e===i.ARROW_RIGHT&&(r=this.utils.mod(r+1,n.length)),e===i.HOME&&(r=0),e===i.END&&(r=n.length-1),n[r].setAttribute("tabindex","0"),n[r].focus()):e===i.ARROW_UP?(this.dropDownModule.getOrCreateInstance(t).show(),setTimeout((()=>{const e=Array.from(o.querySelectorAll(".clip-link"));e[e.length-1].focus()}),PuzzleElement.FOCUS_DELAY_MS)):e===i.ARROW_DOWN||e===i.ENTER||e===i.SPACE?(this.dropDownModule.getOrCreateInstance(t).show(),setTimeout((()=>{Array.from(o.querySelectorAll(".clip-link"))[0].focus()}),PuzzleElement.FOCUS_DELAY_MS)):e===i.ESCAPE&&t.blur(),!0}dropItem(e){if(this.grabbed){const t=this.grabbed.closest(".dropdown");t.parentElement.innerHTML="",e.append(t),this.grabbed.setAttribute("aria-grabbed","false"),this.grabbed.focus(),this.grabbed=null}this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder").forEach((e=>e.setAttribute("aria-dropeffect","")))}dragItem(e){Array.from(this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder")).filter((e=>""===e.innerHTML)).forEach((e=>e.setAttribute("aria-dropeffect","move"))),this.grabbed&&this.grabbed.setAttribute("aria-grabbed","false"),this.grabbed=e,this.grabbed.setAttribute("aria-grabbed","true")}resizeSVG(){const e=this.layer.getAttribute("viewBox");if(e){const t=parseInt(e.split(" ")[2]),o=this.layer.clientWidth,n=Array.from(this.layer.querySelectorAll(".clip-placeholder"));let i=t/o,r=Math.min(...n.map((e=>e.clientWidth))),l=Math.min(...n.map((e=>e.clientHeight))),s=Math.min(r,l);this.layer.querySelectorAll(".clip-text").forEach((e=>{e.style.fontSize=Math.min(s,Math.round(30*i))+"px"})),this.layer.querySelectorAll(".clip-text-circle").forEach((e=>{e.setAttribute("r",Math.min(s/2,Math.round(24*i)).toString()),e.style.strokeWidth=Math.round(2*i)+"px"}))}}init(){const e=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){yield e.init.call(this),this.dropDownModule=yield this.bootstrap.loadDropdownModule(),this.background=this.widget.querySelector(".puzzle-background"),this.layer=this.widget.querySelector(".interactive-layer"),window.addEventListener("resize",(()=>this.resizeSVG())),this.widget.addEventListener("dragstart",(e=>{e.target instanceof HTMLElement&&e.target.closest(".piece")&&this.dragItem(e.target.closest(".piece"))})),this.widget.addEventListener("keydown",(e=>{if(e.target instanceof HTMLElement){const t=e.target.closest(".piece[data-bs-toggle]");t&&this.onKeyDownInput(e.code,t)&&e.preventDefault()}})),this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder").forEach((e=>{e.addEventListener("dragover",(t=>{null===e.querySelector(".piece")&&(t.dataTransfer.dropEffect="move",t.preventDefault())})),e.addEventListener("drop",(e=>this.dropItem(e.target)))})),this.widget.addEventListener("click",(e=>{if(e.target instanceof HTMLElement)if(e.target.classList.contains("btn-check-answer"))this.check();else if(e.target.classList.contains("btn-reset"))this.reset();else if(e.target.classList.contains("clip-link")){e.preventDefault();const t=e.target.dataset.pos,o=this.widget.querySelector(`.piece-wrapper[data-pos="${t}"]`),n=o.querySelector(".piece");if(n){const e=Array.from(this.widget.querySelectorAll(".piece-placeholder")).find((e=>""===e.innerHTML));e&&e.append(n.closest(".dropdown"))}setTimeout((()=>this.dropItem(o)),1)}else{const t=e.target.closest(".piece");if(t){const e=t.closest(".dropdown").querySelector(".clip-link");setTimeout((()=>e.focus()),PuzzleElement.FOCUS_DELAY_MS)}}})),this.widget.addEventListener("show.bs.dropdown",(e=>{if(e.target instanceof HTMLElement&&e.target.classList.contains("dropdown")){const t=e.target.closest("foreignObject");t&&this.layer.append(t)}})),this.widget.addEventListener("shown.bs.dropdown",(e=>{if(e.target instanceof HTMLElement){const t=e.target.closest(".dropdown");t&&this.dragItem(t.querySelector(".piece"))}})),this.widget.addEventListener("hidden.bs.dropdown",(e=>{if(e.target instanceof HTMLElement&&e.target.classList.contains("dropdown")){e.target.querySelector(".piece").setAttribute("aria-grabbed","false"),this.widget.querySelectorAll(".piece-wrapper, .piece-placeholder").forEach((e=>e.setAttribute("aria-dropeffect","")))}}))}))}voiceControlCheck(){this.check()}voiceControlGoto(e){const t=null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece"));t[this.utils.mod(e,t.length)].focus()}voiceControlMove(e){if(null!==this.widget.querySelector(".dropdown-menu.show"))return;const t=this.widget.querySelector('.piece-wrapper[data-pos="'+e+'"]');if(!t)return void this.voiceControlUnknown();const o=t.querySelector(".piece");if(o){const e=Array.from(this.widget.querySelectorAll(".piece-placeholder")).find((e=>""===e.innerHTML));e&&e.append(o.closest(".dropdown"))}const n=Array.from(this.widget.querySelectorAll(".piece")),i=n.find((e=>e===document.activeElement))||n[0];this.grabbed=i,setTimeout((()=>this.dropItem(t)),1)}voiceControlNext(){const e=null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece")),t=e.find((e=>e===document.activeElement));if(t){const o=e.indexOf(t);e[this.utils.mod(o+1,e.length)].focus()}else e[0].focus()}voiceControlPrevious(){const e=null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece")),t=e.find((e=>e===document.activeElement));if(t){const o=e.indexOf(t);e[this.utils.mod(o-1,e.length)].focus()}else e[e.length-1].focus()}voiceControlSelect(){const e=(null!==this.widget.querySelector(".dropdown-menu.show")?Array.from(this.widget.querySelector(".dropdown-menu.show").querySelectorAll(".clip-link")):Array.from(this.widget.querySelectorAll(".piece"))).find((e=>e===document.activeElement));e&&e.click()}voiceControlStart(){super.voiceControlStart(),this.voiceControlGoto(0)}voiceControlRepeat(){const e=null!==this.widget.querySelector(".dropdown-menu.show");this.voiceControlMessageElem.innerHTML+=this.utils.alert("alert-info",this.i18n.value("tta-info-puzzle-"+(e?"options":"terms")))}voiceControlReset(){this.reset()}}PuzzleElement.FOCUS_DELAY_MS=100;const l=PuzzleElement},6088:(e,t,o)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(e,t,o){if(e==t)return o.fn(this)}o.r(t),o.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__})},20884:(e,t,o)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(e,t,o){if(e!=t)return o.fn(this)}o.r(t),o.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__})}}]);