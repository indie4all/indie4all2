!function(){const o=io({forceNew:!0});var t=window.location.pathname.split("/");const i=t[t.length-2],a=i+"-username",m=i+"-uuid",c=i+"-date";let s=JSON.parse(sessionStorage.getItem(a));s||window.location.replace("index.html");let l=JSON.parse(sessionStorage.getItem(m))||([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));sessionStorage.setItem(m,JSON.stringify(l));let d=sessionStorage.getItem(c)||Date.now();o.emit("join-room",i);function n(t,r){o.on("redirect-game-finished",i=>{sessionStorage.removeItem(a),sessionStorage.removeItem(m),sessionStorage.removeItem(c);let s=i.find(t=>t.id===l),e=$("#gamification-message-modal");function n(t){t.find(".gamification-ranking").remove();let e=function(t,o){let e=$("<tr />").append($("<td/>").addClass("empty").attr("colspan",3).html("..."));t.sort((t,e)=>e.points-t.points);let n=t.filter((t,e)=>e<3||t===o),a=n.map(function(t,e){var n=$("<td />").html(e+1),a=$("<td />").html(t.username),e=$("<td />").html(t.points);return $("<tr />").toggleClass("current",t===o).append(n,a,e)});3<n.length&&a.splice(3,0,e.clone()),a.push(e.clone());var i=$("<tr />").append($("<th />").attr("colspan",3).html(r("gamification-results"))),t=$("<tr />").append($("<th />").html(r("gamification-position")),$("<th />").html(r("gamification-username")),$("<th />").html(r("gamification-points"))),i=$("<thead />").append(i,t),t=$("<tbody />").html(a);return $("<table/>").addClass("gamification-ranking table mx-auto").append(i,t)}(i,s);var n=s&&s.res?"https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-correct.png":"https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-wrong.png",a=s&&s.res?r("TextCorrectAnswer"):r("TextIncorrectAnswer"),o=s&&s.res?r("GamyCorrect"):r("GamyWrong");t.find(".modal-title").html(a),t.find(".modal-logo-img").attr("src",n).attr("alt",o),t.find(".modal-body").append(e),e.delay(1500).show(700),setTimeout(function(){t.removeClass("changing")},100)}if(e.hasClass("show")){let t=e.clone();e.css("opacity",0),setTimeout(function(){e.remove()},300),t.addClass("changing"),n(t),t.modal("show")}else e.addClass("changing"),n(e),e.modal("show")}),$(document).on("gamificate",".btn-gamification",function(t,e,n){let a=$("#gamification-message-modal");a.find(".modal-title").html(r("AnswerSent")),a.find(".modal-logo-img").attr("src","https://cdn-cpcd-upct-e2bdhub5efg7c9hk.z01.azurefd.net/$web/img/gamy-ok.png").attr("alt",r("GamyGreeting")),a.modal("show"),$(this).attr("disabled",!0),o.emit("question-response",{id:l,res:e,username:s,room:i,time:Date.now()-d,score:n})})}let r=document.currentScript.src;r=r.substr(0,r.lastIndexOf("/")),$(document).ready(function(){setTimeout(function(){$(".btn-gamification").attr("aria-haspopup","dialog")},500);let e=$("html").attr("lang");fetch(`${r}/../languages/${e}.json`).then(t=>t.json()).then(t=>i18next.createInstance({lng:e,resources:{[e]:{translation:t}}},n))})}();