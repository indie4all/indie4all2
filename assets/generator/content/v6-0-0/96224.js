/*! For license information please see 96224.js.LICENSE.txt */
"use strict";(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[96224,7885,13027],{96224:(e,t,r)=>{r.d(t,{default:()=>u});var n=r(65360),i=r(13027),s=r(18987),o=r(7885),c=r(70583),__decorate=function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let a=class AuthIndieService extends o.default{constructor(e,t){super(e,t),this.cipherService=e,this.utils=t,this.USER_KEY="INDIE_USER"}async init(e){this.unitId=e;try{const e=s.A.get(this.USER_KEY);if(!e)return;const t=await this.cipherService.decrypt(e);this.currentUser=JSON.parse(t);const r=this.decodeToken(this.currentUser.access_token);this.currentUser.roles=r.authorities}catch(e){console.error("[ERROR] Error parsing user information")}}canStartGamification(){var e;return!!this.currentUser&&(!this.isAccessTokenExpired()&&!(null===(e=this.currentUser.roles)||void 0===e?void 0:e.includes("ROLE_STUDENT")))}};a=__decorate([(0,n.k)({global:!0}),__metadata("design:paramtypes",[i.default,c.A])],a);const u=a},7885:(e,t,r)=>{r.d(t,{default:()=>c});var n=r(65360),i=r(13027),s=r(70583),__decorate=function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let o=class AuthService{constructor(e,t){this.cipherService=e,this.utils=t}decodeToken(e){let t=e,r=this.utils.base64UrlDecode(null==t?void 0:t.split(".")[1]).toString();return JSON.parse(r)}getTokenExpirationTimeMs(e){if(this.currentUser&&this.currentUser[e]){let t=this.currentUser[e],r=this.utils.base64UrlDecode(null==t?void 0:t.split(".")[1]).toString();return 1e3*JSON.parse(r).exp}return null}isAccessTokenExpired(){return this.isTokenExpired("access_token")}isRefreshTokenExpired(){return this.isTokenExpired("refresh_token")}isTokenExpired(e){const t=this.getTokenExpirationTimeMs(e);if(Number.isFinite(t)){return Math.floor((new Date).getTime())>=t}return!1}get currentUser(){return this._currentUser}set currentUser(e){this._currentUser=e}};o=__decorate([(0,n.k)({global:!0}),__metadata("design:paramtypes",[i.default,s.A])],o);const c=o},13027:(e,t,r)=>{r.d(t,{default:()=>o});var n=r(65360),i=r(70583),__decorate=function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let s=class CipherService{constructor(e){this.utils=e,this.encoder=new TextEncoder,this.key=this.encoder.encode("2yWfEgocFom9jbWN"),this.iv=this.encoder.encode("AODVNUASDNVVAOVF")}async encrypt(e){const t=await window.crypto.subtle.importKey("raw",this.key,"AES-CBC",!1,["encrypt"]),r=this.utils.str2ab(e),n=await window.crypto.subtle.encrypt({name:"AES-CBC",iv:this.iv},t,r);return btoa(this.utils.ab2str(n))}async decrypt(e){const t=await window.crypto.subtle.importKey("raw",this.key,"AES-CBC",!1,["decrypt"]),r=this.utils.str2ab(atob(e)),n=await window.crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},t,r);return this.utils.ab2str(n)}};s=__decorate([(0,n.k)({global:!0}),__metadata("design:paramtypes",[i.A])],s);const o=s},18987:(e,t,r)=>{function assign(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{A:()=>n});var n=function init(e,t){function set(r,n,i){if("undefined"!=typeof document){"number"==typeof(i=assign({},t,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var o in i)i[o]&&(s+="; "+o,!0!==i[o]&&(s+="="+i[o].split(";")[0]));return document.cookie=r+"="+e.write(n,r)+s}}return Object.create({set,get:function get(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var s=r[i].split("="),o=s.slice(1).join("=");try{var c=decodeURIComponent(s[0]);if(n[c]=e.read(o,c),t===c)break}catch(e){}}return t?n[t]:n}},remove:function(e,t){set(e,"",assign({},t,{expires:-1}))},withAttributes:function(e){return init(this.converter,assign({},this.attributes,e))},withConverter:function(e){return init(assign({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}}]);