(self.webpackChunkCDN=self.webpackChunkCDN||[]).push([[6913,7523],{36097:(t,e,o)=>{var i=o(93633);function __default(t){return t&&(t.__esModule?t.default:t)}t.exports=(i.default||i).template({1:function(t,e,i,n,s,r,c){var a,l=null!=e?e:t.nullContext||{},h=t.escapeExpression,u=t.lambda,d=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"      <tr "+(null!=(a=__default(o(6088)).call(l,null!=(a=null!=c[1]?d(c[1],"me"):c[1])?d(a,"id"):a,null!=(a=r[0][0])?d(a,"id"):a,{name:"ifeq",hash:{},fn:t.program(2,s,0,r,c),inverse:t.noop,data:s,blockParams:r,loc:{start:{line:15,column:10},end:{line:15,column:63}}}))?a:"")+">\r\n        <td>"+h(__default(o(32625)).call(l,s&&d(s,"index"),{name:"inc",hash:{},data:s,blockParams:r,loc:{start:{line:16,column:12},end:{line:16,column:26}}}))+"</td>\r\n        <td>"+h(u(null!=(a=r[0][0])?d(a,"name"):a,e))+"</td>\r\n        <td>"+h(u(null!=(a=r[0][0])?d(a,"points"):a,e))+"</td>\r\n        <td>"+h(u(null!=(a=r[0][0])?d(a,"total"):a,e))+"</td>\r\n      </tr>\r\n"},2:function(t,e,o,i,n){return'class="current"'},compiler:[8,">= 4.3.0"],main:function(t,e,i,n,s,r,c){var a,l=null!=e?e:t.nullContext||{},h=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<table class="gamification-ranking table mx-auto">\r\n  <thead>\r\n    <tr>\r\n        <th colspan="4">'+h(__default(o(61867)).call(l,"gamification-results",{name:"translate",hash:{},data:s,blockParams:r,loc:{start:{line:4,column:24},end:{line:4,column:60}}}))+"</th>\r\n    </tr>\r\n    <tr>\r\n        <th>"+h(__default(o(61867)).call(l,"gamification-position",{name:"translate",hash:{},data:s,blockParams:r,loc:{start:{line:7,column:12},end:{line:7,column:49}}}))+"</th>\r\n        <th>"+h(__default(o(61867)).call(l,"gamification-username",{name:"translate",hash:{},data:s,blockParams:r,loc:{start:{line:8,column:12},end:{line:8,column:49}}}))+"</th>\r\n        <th>"+h(__default(o(61867)).call(l,"gamification-points",{name:"translate",hash:{},data:s,blockParams:r,loc:{start:{line:9,column:12},end:{line:9,column:47}}}))+"</th>\r\n        <th>"+h(__default(o(61867)).call(l,"gamification-total",{name:"translate",hash:{},data:s,blockParams:r,loc:{start:{line:10,column:12},end:{line:10,column:46}}}))+"</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n"+(null!=(a=u(i,"each").call(l,null!=e?u(e,"students"):e,{name:"each",hash:{},fn:t.program(1,s,1,r,c),inverse:t.noop,data:s,blockParams:r,loc:{start:{line:14,column:4},end:{line:21,column:13}}}))?a:"")+"  </tbody>\r\n</table>"},useData:!0,useDepths:!0,useBlockParams:!0})},19412:(t,e,o)=>{"use strict";o.d(e,{A:()=>Element});var i=o(16126),n=o(3605),__awaiter=function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function fulfilled(t){try{step(i.next(t))}catch(t){s(t)}}function rejected(t){try{step(i.throw(t))}catch(t){s(t)}}function step(t){t.done?n(t.value):function adopt(t){return t instanceof o?t:new o((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())}))};class Element{constructor(t,e,o){this.voiceControl=t,this.utils=e,this.i18n=o,this._activityNumber=0}init(){return __awaiter(this,void 0,void 0,(function*(){if(!this._widget)throw new Error("ElementHTML widget has not been set.");this.voiceControlMessageElem=this.widget.querySelector(".tta-message"),this.voiceControlButton=document.querySelector(`#speech-to-action-${this.id}`),this.voiceControlButton&&(this.voiceControlButton.addEventListener("click",(()=>{if(this.voiceControl.currentTarget!==this.id){for(;this.voiceControl.numTargets>1;)this.voiceControl.popTarget();return this._parent&&this.voiceControl.addTarget(this._parent.id),void this.voiceControl.addTarget(this.id)}this.voiceControl.popTarget(),this.voiceControlButton&&this.toggleVoiceControlButton(!1)})),this.voiceControl.voiceControlTargetChanged.subscribe((t=>{this.id===t.old&&this.toggleVoiceControlButton(!1),this.id===t.new&&this.toggleVoiceControlButton(!0)})),this.voiceControl.voiceControlActions.pipe((0,i.p)((t=>t.target===this.id))).subscribe((t=>{t instanceof n.m6?this.voiceControlStart():t instanceof n.$q?this.voiceControlFinish():t instanceof n.DZ?this.voiceControlNext():t instanceof n.vZ?this.voiceControlPrevious():t instanceof n.Fd?this.voiceControlGoto(t.position):t instanceof n.V3?this.voiceControlBack():t instanceof n.gZ?this.voiceControlSelect():t instanceof n.CG?this.voiceControlClose():t instanceof n.sT?this.voiceControlCheck():t instanceof n.XR?this.voiceControlCurrent():t instanceof n.B$?this.voiceControlDelete():t instanceof n._R?this.voiceControlMaximize():t instanceof n.EZ?this.voiceControlMinimize():t instanceof n.$V?this.voiceControlMove(t.position):t instanceof n.ow?this.voiceControlPause():t instanceof n.OR?this.voiceControlPlay():t instanceof n.pr?this.voiceControlRepeat():t instanceof n.lR?this.voiceControlReset():t instanceof n.m6?this.voiceControlStart():t instanceof n.o3?this.voiceControlStop():t instanceof n.HU?this.voiceControlWrite(t.text):t instanceof n.kw&&this.voiceControlUnknown()})))}))}get description(){return this.widget.dataset.desc||""}get id(){return this.widget.id}get type(){return this.widget.dataset.type||""}get widget(){return this._widget}set widget(t){this._widget=t}get parent(){return this._parent}set parent(t){this._parent=t}set activityNumber(t){this._activityNumber=t,this.voiceControlButton&&(this.voiceControlButton.innerHTML+=`<span class="element-number">${this.i18n.value("tta-activity-number")} ${t}</span>`)}toggleHighlight(t){this.widget.classList.toggle("speech-focused",t)}toggleVoiceControlButton(t){if(this.voiceControlButton){const e=this.voiceControlButton.querySelector("svg");e&&(e.classList.toggle("fa-head-side-cough",t),e.classList.toggle("fa-head-side-cough-slash",!t))}}showVoiceControlButton(){this.voiceControlButton&&(this.voiceControlButton.classList.add("show"),this.toggleVoiceControlButton(!1))}hideVoiceControlButton(){this.voiceControlButton&&this.voiceControlButton.classList.remove("show")}voiceControlStart(){this.toggleVoiceControlButton(!0)}voiceControlFinish(){this.voiceControl.popTarget(),this.toggleVoiceControlButton(!1)}voiceControlClose(){this.voiceControlUnknown()}voiceControlCheck(){this.voiceControlUnknown()}voiceControlCurrent(){this.voiceControlUnknown()}voiceControlDelete(){this.voiceControlUnknown()}voiceControlMaximize(){this.voiceControlUnknown()}voiceControlMinimize(){this.voiceControlUnknown()}voiceControlMove(t){this.voiceControlUnknown()}voiceControlPause(){this.voiceControlUnknown()}voiceControlPlay(){this.voiceControlUnknown()}voiceControlRepeat(){this.voiceControlUnknown()}voiceControlReset(){this.voiceControlUnknown()}voiceControlStop(){this.voiceControlUnknown()}voiceControlWrite(t){this.voiceControlUnknown()}voiceControlNext(){this.voiceControlUnknown()}voiceControlPrevious(){this.voiceControlUnknown()}voiceControlGoto(t){this.voiceControlUnknown()}voiceControlBack(){this.voiceControlUnknown()}voiceControlSelect(){this.voiceControlUnknown()}voiceControlUnknown(){this.voiceControlMessageElem.innerHTML+=this.utils.alert("alert-danger",this.i18n.value("tta-error-message"))}}},97523:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>l});var i=o(65360),n=o(96107),s=o(94442),r=o(37115),c=o(35999),__decorate=function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function fulfilled(t){try{step(i.next(t))}catch(t){s(t)}}function rejected(t){try{step(i.throw(t))}catch(t){s(t)}}function step(t){t.done?n(t.value):function adopt(t){return t instanceof o?t:new o((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())}))};let a=class GamificationService{constructor(t){this.interaction=t,this._code="test",this._scoresHistory=[],this.gamificationSubject=new n.B,this.gamificationEvents$=this.gamificationSubject.asObservable(),this.studentsChangedSubject=new s.m(1),this.studentsChanged$=this.studentsChangedSubject.asObservable()}get gamificationEvents(){return this.gamificationEvents$}get finalScores(){const t=this.scoresHistory[this.step],e=this.students.map((e=>{const o=t.find((t=>t.id===e.id)),i=this.scoresHistory.map((t=>{var o;return(null===(o=t.find((t=>t.id===e.id)))||void 0===o?void 0:o.points)||0})).reduce(((t,e)=>t+e),0);return{id:e.id,name:e.name,time:(null==o?void 0:o.time)||0,points:(null==o?void 0:o.points)||0,correct:(null==o?void 0:o.correct)||!1,total:i}}));return e.sort(((t,e)=>e.total-t.total)),e}get scoresHistory(){return this._scoresHistory||(this._scoresHistory=JSON.parse(sessionStorage.getItem(this._code+"-scores"))||[]),this._scoresHistory}set scoresHistory(t){this._scoresHistory=t,sessionStorage.setItem(this._code+"-scores",JSON.stringify(t))}get activity(){return this._activity}set activity(t){this._activity=t}get code(){return this._code}set code(t){this._code=t}get user(){return this._user||(this._user=JSON.parse(sessionStorage.getItem(this._code+"-user"))),this._user}set user(t){this._user=t,sessionStorage.setItem(this._code+"-user",JSON.stringify(t))}get socket(){return this._socket}set socket(t){this._socket=t}get step(){return"number"!=typeof this._step&&(this._step=JSON.parse(sessionStorage.getItem(this._code+"-step"))||0),this._step}set step(t){this._step=t,sessionStorage.setItem(this._code+"-step",JSON.stringify(t))}get students(){return this._students||(this._students=JSON.parse(sessionStorage.getItem(this._code+"-students"))||[],this.studentsChangedSubject.next(this._students)),this._students.forEach((t=>{var e;return t.answered=void 0!==(null===(e=this.scoresHistory[this.step])||void 0===e?void 0:e.find((e=>e.id===t.id))),t})),this._students}set students(t){this._students=t,sessionStorage.setItem(this._code+"-students",JSON.stringify(t)),this.studentsChangedSubject.next(t)}get studentsChanged(){return this.studentsChanged$}join(){this._socket.emit("join-room",this._code,this.user.id,{username:this.user.name})}init(){return __awaiter(this,void 0,void 0,(function*(){this._socket=(0,r.io)("http://cpcdpruebas.upct.es:3000",{forceNew:!0})}))}};a=__decorate([(0,i.k)({global:!0}),__metadata("design:paramtypes",[c.A])],a);const l=a},73938:(t,e,o)=>{"use strict";o.d(e,{$Y:()=>GamificationResultEvent,an:()=>GamificationTeacherStopEvent,aq:()=>GamificationTeacherFinishedEvent,tS:()=>GamificationTeacherAckEvent,wU:()=>GamificationTeacherNextActivityEvent});class GamificationEvent{}class GamificationTeacherAckEvent extends GamificationEvent{get step(){return this._step}set step(t){this._step=t}get questions(){return this._questions}set questions(t){this._questions=t}}class GamificationTeacherStopEvent extends GamificationEvent{}class GamificationResultEvent{constructor(t=[]){this._info=t}get info(){return this._info}}class GamificationTeacherNextActivityEvent extends GamificationResultEvent{}class GamificationTeacherFinishedEvent extends GamificationResultEvent{}},52176:(t,e,o)=>{"use strict";o.d(e,{A:()=>g});var i=o(65360),n=o(16126),s=o(73938),r=o(7979),c=o(24971),a=o(40561),l=o(97523),h=o(44295),u=o(37607),d=o(89953),f=o(75521),v=o(70583),m=o(61709),__decorate=function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function fulfilled(t){try{step(i.next(t))}catch(t){s(t)}}function rejected(t){try{step(i.throw(t))}catch(t){s(t)}}function step(t){t.done?n(t.value):function adopt(t){return t instanceof o?t:new o((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())}))};let p=class GamificationUnit extends f.default{constructor(t,e,o,i,n,s,r,c,a){super(t,e,o,i,n,s,r,a),this.factory=t,this.menu=e,this.voiceControl=o,this.bootstrap=i,this.utils=n,this.i18n=s,this.code=r,this.gamification=c,this.mathjax=a}init(){const t=Object.create(null,{init:{get:()=>super.init}});return __awaiter(this,void 0,void 0,(function*(){if(yield t.init.call(this),1!==this.rootElements.length)throw new Error("Gamification units should have exactly one root element");this.modalModule=yield this.bootstrap.loadModalModule(),this.modal=document.querySelector("#gamification-message-modal"),this.activity=this.rootElements[0];const e=window.location.pathname.split("/"),o=parseInt(e[e.length-2]);o&&(this.gamification.code=o.toString()),this.gamification.activity=this.activity,this.gamification.gamificationEvents.pipe((0,n.p)((t=>t instanceof s.$Y))).subscribe((t=>this.showScore(t.info)))}))}};p=__decorate([(0,i.k)(),__metadata("design:paramtypes",[a.default,d.A,m.A,r.A,v.A,h.A,c.A,l.default,u.A])],p);const g=p},6088:(t,e,o)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(t,e,o){if(t==e)return o.fn(this)}o.r(e),o.d(e,{default:()=>__WEBPACK_DEFAULT_EXPORT__})},32625:(t,e,o)=>{"use strict";function __WEBPACK_DEFAULT_EXPORT__(t,e){return parseInt(t)+1}o.r(e),o.d(e,{default:()=>__WEBPACK_DEFAULT_EXPORT__})}}]);